<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Middle East Journey | Trip Manager</title>
    <style>
        :root {
            /* Palette: Japanese Minimalist x Desert Vibes */
            --bg-color: #FDFBF7; /* ç±³ç™½è‰²èƒŒæ™¯ */
            --card-bg: #FFFFFF;
            --text-main: #2C2C2C;
            --text-sub: #8E8E93;
            --accent-gold: #C5A065; /* æ²™æ¼ é‡‘ */
            --accent-blue: #6B8E9B; /* æ½Ÿæ¹–è— */
            --accent-green: #7F9172; /* é¾è¡€æ¨¹ç¶  */
            --border-radius: 12px;
            --shadow: 0 2px 10px rgba(0,0,0,0.04);
            --nav-height: 70px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-main);
            padding-bottom: calc(var(--nav-height) + 20px);
        }

        /* HEADER */
        header {
            position: sticky;
            top: 0;
            background: rgba(253, 251, 247, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            z-index: 100;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        h1 { margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.05em; }
        .date-badge { font-size: 12px; background: #eee; padding: 4px 8px; border-radius: 4px; color: #666; }

        /* TABS */
        .section { display: none; padding: 20px; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS (TIMELINE) */
        .day-container { margin-bottom: 30px; }
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            position: sticky;
            top: 60px;
            z-index: 90;
        }
        .day-date { font-size: 16px; font-weight: 700; color: var(--text-main); }
        .day-weather { font-size: 12px; color: var(--text-sub); display: flex; align-items: center; gap: 5px; background: #fff; padding: 4px 10px; border-radius: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
            position: relative;
            border-left: 3px solid transparent;
        }

        .card.flight { border-left-color: var(--text-sub); }
        .card.stay { border-left-color: var(--accent-gold); }
        .card.activity { border-left-color: var(--accent-blue); }
        .card.food { border-left-color: var(--accent-green); }

        .card-meta { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 12px; color: var(--text-sub); font-weight: 500; }
        .card-title { font-size: 15px; font-weight: 600; margin-bottom: 8px; line-height: 1.4; }
        .card-desc { font-size: 13px; color: #666; line-height: 1.6; margin-bottom: 12px; }
        
        /* Guide Highlights */
        .highlight-box { background: #F7F9FA; padding: 8px 12px; border-radius: 8px; font-size: 12px; margin-top: 8px; border-left: 2px solid var(--accent-blue); }
        .tag { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; margin-right: 5px; }
        .tag.tip { background: #FFF3E0; color: #EF6C00; }
        .tag.eco { background: #E8F5E9; color: #2E7D32; }
        .tag.must { background: #FFEBEE; color: #C62828; }

        .btn-nav {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #F2F2F7;
            color: var(--text-main);
            padding: 6px 12px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 12px;
            font-weight: 500;
            margin-top: 5px;
            transition: background 0.2s;
        }
        .btn-nav:active { background: #E5E5EA; }

        /* FLIGHTS TABLE */
        .flight-card { background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: var(--shadow); }
        .flight-header { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px; }
        .flight-route { font-weight: bold; font-size: 16px; }
        .flight-date { color: var(--text-sub); font-size: 12px; }
        .flight-detail-row { display: flex; justify-content: space-between; font-size: 13px; margin-top: 8px; }
        .flight-time { font-weight: 600; color: var(--text-main); }
        .flight-label { color: var(--text-sub); font-size: 11px; }

        /* CHECKLIST */
        .check-group { margin-bottom: 25px; }
        .check-title { font-size: 14px; font-weight: 600; color: var(--accent-gold); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .check-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #fff;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .check-item:first-child { border-top-left-radius: 12px; border-top-right-radius: 12px; }
        .check-item:last-child { border-bottom-left-radius: 12px; border-bottom-right-radius: 12px; border-bottom: none; }
        
        .checkbox { width: 20px; height: 20px; border: 2px solid #ddd; border-radius: 50%; margin-right: 12px; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .check-item.checked .checkbox { background: var(--accent-green); border-color: var(--accent-green); }
        .check-item.checked .checkbox::after { content: 'âœ“'; color: white; font-size: 12px; }
        .check-item.checked span { text-decoration: line-through; color: #bbb; }

        /* BOTTOM NAV */
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-around;
            height: var(--nav-height);
            padding-bottom: 10px; /* Safe area */
            z-index: 1000;
        }
        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #ccc;
            font-size: 10px;
            cursor: pointer;
        }
        .nav-item.active { color: var(--text-main); }
        .nav-icon { font-size: 20px; margin-bottom: 4px; }

    </style>
</head>
<body>

    <header>
        <div>
            <h1>Middle East Trip</h1>
            <span style="font-size: 11px; color: #888;">Feb 15 - Feb 26, 2026</span>
        </div>
        <div class="date-badge">11 Days</div>
    </header>

    <div id="tab-timeline" class="section active">
        </div>

    <div id="tab-info" class="section">
        <h2 style="font-size:18px; margin-bottom:15px;">âœˆï¸ èˆªç­è³‡è¨Š</h2>
        <div id="flight-list"></div>

        <h2 style="font-size:18px; margin: 30px 0 15px 0;">ğŸ¨ ä½å®¿èˆ‡åœ°åœ–</h2>
        <div id="stay-list"></div>
    </div>

    <div id="tab-checklist" class="section">
        <h2 style="font-size:18px; margin-bottom:15px;">ğŸ’ æ‰“åŒ…æ¸…å–®</h2>
        <div id="checklist-container"></div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="switchTab('timeline', this)">
            <span class="nav-icon">ğŸ“…</span>
            è¡Œç¨‹
        </div>
        <div class="nav-item" onclick="switchTab('info', this)">
            <span class="nav-icon">âœˆï¸</span>
            è³‡è¨Š
        </div>
        <div class="nav-item" onclick="switchTab('checklist', this)">
            <span class="nav-icon">âœ…</span>
            æ‰“åŒ…
        </div>
    </nav>

    <script>
        // --- DATA CONFIGURATION ---
        
        // Locations for Weather API (Lat, Lon)
        const coords = {
            "Taipei": {lat: 25.03, lon: 121.56},
            "Dubai": {lat: 25.20, lon: 55.27},
            "Jeddah": {lat: 21.48, lon: 39.19},
            "Socotra": {lat: 12.65, lon: 54.02}, // Using Hadibo as proxy
            "AbuDhabi": {lat: 24.45, lon: 54.37}
        };

        const flights = [
            { date: "2/15 (æ—¥)", no: "EK367", route: "TPE â†’ DXB", dep: "23:00", arr: "04:50 (+1)", term: "-" },
            { date: "2/16 (ä¸€)", no: "XY502", route: "DXB â†’ JED", dep: "12:20", arr: "14:45", term: "-" },
            { date: "2/17 (äºŒ)", no: "IY525", route: "JED â†’ SCT", dep: "11:00", arr: "14:30", term: "-" },
            { date: "2/23 (ä¸€)", no: "IY526", route: "SCT â†’ JED", dep: "10:30", arr: "14:00 (Est)", term: "-" },
            { date: "2/23 (ä¸€)", no: "XY505", route: "JED â†’ DXB", dep: "17:00", arr: "20:45", term: "-" },
            { date: "2/26 (å››)", no: "EK386", route: "DXB â†’ TPE", dep: "08:45", arr: "20:40", term: "3" }
        ];

        const stays = [
            { name: "Best Western Plus Jeddah", addr: "Madinah Road, Jeddah", map: "Best Western Plus Jeddah Hotel Madinah Road" },
            { name: "Socotra Campsites", addr: "Erisel / Fermhin / Detwah", map: "Socotra" },
            { name: "Grande Signature Apartments", addr: "Downtown Dubai", map: "Grande Signature Apartments Dubai" }
        ];

        const itinerary = [
            {
                date: "2/15 (æ—¥)", title: "å‡ºç™¼", location: "Taipei",
                items: [
                    { type: "flight", time: "23:00", title: "EK367 èµ·é£›", desc: "å°åŒ— TPE å‰å¾€æœæ‹œ DXBã€‚è«‹ææ—© 3 å°æ™‚æŠµé”æ©Ÿå ´ã€‚", nav: "Taoyuan International Airport" }
                ]
            },
            {
                date: "2/16 (ä¸€)", title: "è½‰æ©Ÿèˆ‡æŠµé”å‰é”", location: "Jeddah",
                items: [
                    { type: "flight", time: "04:50", title: "æŠµé”æœæ‹œ (DXB)", desc: "è½‰æ©Ÿç­‰å¾…æ™‚é–“ç´„ 7.5 å°æ™‚", nav: "Dubai International Airport" },
                    { type: "flight", time: "12:20", title: "XY502 èµ·é£›", desc: "å‰å¾€å‰é” (JED)", nav: null },
                    { type: "stay", time: "15:30", title: "Check-in Hotel", desc: "Best Western Plus Jeddahã€‚æ”¾ç½®è¡Œæç¨ä½œä¼‘æ¯ã€‚", nav: "Best Western Plus Jeddah Hotel Madinah Road" },
                    { type: "food", time: "19:00", title: "Waterfront Dinner", desc: "åœ¨å‰é”æ¿±æµ·è·¯äº«å—æ™šé¤ã€‚", nav: "Jeddah Corniche" }
                ]
            },
            {
                date: "2/17 (äºŒ)", title: "å‰å¾€ç´¢ç§‘ç‰¹æ‹‰", location: "Socotra",
                items: [
                    { type: "flight", time: "11:00", title: "IY525 èµ·é£›", desc: "å‰å¾€ç¥ç§˜å³¶å¶¼ç´¢ç§‘ç‰¹æ‹‰ (SCT)", nav: "King Abdulaziz International Airport" },
                    { type: "stay", time: "15:00", title: "Erisel Beach éœ²ç‡Ÿ", desc: "æŠµé”å¾Œæ­ä¹˜ 4x4 å‰å¾€å³¶å¶¼æ±éƒ¨ã€‚é€”ç¶“é¦–åºœ Hadiboï¼Œé çœº Hajhair å±±è„ˆã€‚<br><span class='highlight-box'><span class='tag eco'>Eco</span>ä»Šæ™šåœ¨ç§äººå¸³ç¯·äº«å—æ˜Ÿç©ºéœ²ç‡Ÿï¼Œå‚™æœ‰ä¾¿æ”œå¼å»æ‰€èˆ‡æ·‹æµ´ã€‚</span>", nav: "Erisel Beach" }
                ]
            },
            {
                date: "2/18 (ä¸‰)", title: "æ²™ä¸˜èˆ‡ç„¡é‚Šéš›æ³³æ± ", location: "Socotra",
                items: [
                    { type: "activity", time: "05:30", title: "Arher ç™½æ²™ä¸˜æ—¥å‡º", desc: "çˆ¬ä¸Šå·¨å¤§æ²™ä¸˜çœ‹æ—¥å‡ºï¼Œé«”é©—æ»‘æ²™æ¨‚è¶£ã€‚<br><span class='highlight-box'><span class='tag tip'>Tips</span>æ—©é¤æ™‚ç•™æ„æµ·é¢ï¼Œæœ‰æ©Ÿæœƒçœ‹åˆ°é£›æ—‹æµ·è±šï¼</span>", nav: "Arher Beach" },
                    { type: "activity", time: "Morning", title: "Dihamri æµ·æ´‹ä¿è­·å€", desc: "æµ®æ½›å‹åœ°ï¼Œæ“æœ‰è±å¯Œçš„é­šé¡å’ŒçŠç‘šç¤ã€‚åŒ…å«åˆé¤ã€‚", nav: "Dihamri Marine Protected Area" },
                    { type: "activity", time: "Afternoon", title: "Homhil ç„¡é‚Šéš›æ³³æ± ", desc: "é€”ç¶“ç“¶å­æ¨¹èˆ‡é¾è¡€æ¨¹å±±è°·ã€‚å¾’æ­¥ä¸‹è¡Œè‡³å¤©ç„¶ç„¡é‚Šéš›æ³³æ± æ¸¸æ³³ï¼Œä¿¯ç°åŒ—å²¸çµ•æ™¯ã€‚", nav: "Homhil Protected Area" }
                ]
            },
            {
                date: "2/19 (å››)", title: "ç™½è‰²å³½è°·èˆ‡æ²™æ¼ ", location: "Socotra",
                items: [
                    { type: "activity", time: "Morning", title: "Kaleesan Canyon", desc: "è¢«ç¨±ç‚ºã€Œç™½è‰²å³½è°·ã€ã€‚ç´”ç™½å²©çŸ³èˆ‡è”šè—æ²³æ°´ã€‚<br><span class='highlight-box'><span class='tag must'>å¿…å‚™</span>è«‹æº–å‚™æ³³è¡£ï¼Œè·³æ°´é«”é©—è¶…æ£’ï¼</span>", nav: "Wadi Kalisan" },
                    { type: "activity", time: "Afternoon", title: "Zahek æ²™æ¼  & é§±é§é«”é©—", desc: "å½·å½¿ã€Šä¸€åƒé›¶ä¸€å¤œã€‹å ´æ™¯ã€‚æ¥è‘—å‰å¾€ Digub Cave æ´ç©´ä¿¯ç°å—å²¸ã€‚", nav: "Zahek Sand Dunes" },
                    { type: "stay", time: "Night", title: "Fermhin Forest éœ²ç‡Ÿ", desc: "ç©¿è¶Š Dirhur å³½è°·ï¼Œåœ¨ä¸–ç•Œæœ€å¤§çš„é¾è¡€æ¨¹æ£®æ—ä¸­éœ²ç‡Ÿã€‚", nav: "Fermhin Forest" }
                ]
            },
            {
                date: "2/20 (äº”)", title: "é¾è¡€æ¨¹èˆ‡è²éƒ½å› æ–‡åŒ–", location: "Socotra",
                items: [
                    { type: "activity", time: "Morning", title: "é¾è¡€æ¨¹æ£®æ—æ¢ç´¢", desc: "åœ°çƒä¸Šé¾è¡€æ¨¹æœ€å¯†é›†çš„å€åŸŸã€‚è§€å¯Ÿç‰¹æœ‰ç¨®æ¤ç‰©èˆ‡é³¥é¡ã€‚", nav: "Dragon Blood Tree Forest" },
                    { type: "activity", time: "Afternoon", title: "æ‹œè¨ªè²éƒ½å› æ‘è½", desc: "é«”é©—ç•¶åœ°ç”Ÿæ´»ä¸¦åƒè§€é¾è¡€æ¨¹è‹—åœƒã€‚<br><span class='highlight-box'><span class='tag eco'>ä¿è‚²</span>é€™äº›æ¨¹ç”Ÿé•·æ¥µæ…¢ï¼Œä¿è‚²å·¥ä½œè‡³é—œé‡è¦ã€‚</span>", nav: null }
                ]
            },
            {
                date: "2/21 (å…­)", title: "è—è‰²æ½Ÿæ¹–å¥‡æ™¯", location: "Socotra",
                items: [
                    { type: "activity", time: "Day", title: "Detwah Lagoon", desc: "å³¶ä¸Šæœ€è‘—åçš„æ™¯é»ã€‚ç™½æ²™èˆ‡è—æ°´å½¢æˆè¶…ç¾å¯¦å°æ¯”ã€‚æ½®æ±è®ŠåŒ–æ™‚æœ‰çµ•ç¾å€’å½±ã€‚", nav: "Detwah Lagoon" },
                    { type: "activity", time: "Sunset", title: "ç™»å±±çœ‹æ—¥è½", desc: "å°‹æ‰¾å­¤ç¨çš„ç“¶å­æ¨¹ï¼Œä¿¯ç°æ•´å€‹æ½Ÿæ¹–ã€‚", nav: null }
                ]
            },
            {
                date: "2/22 (æ—¥)", title: "é»ƒé‡‘æµ·ç˜èˆ‡æµ·è±š", location: "Socotra",
                items: [
                    { type: "activity", time: "Morning", title: "Shoab Beach èˆ¹éŠ", desc: "ä¹˜èˆ¹å‰å¾€ã€Œé»ƒé‡‘æµ·ç˜ã€ï¼Œæ²¿é€”è§€è³å²©çŸ³çµæ§‹èˆ‡æˆç¾¤çš„é£›æ—‹æµ·è±šã€‚", nav: "Shoab Beach" },
                    { type: "activity", time: "Afternoon", title: "Qalansiyah å°é®", desc: "è¼•é¬†çš„æµ·ç˜æ™‚å…‰å¾Œï¼Œåƒè§€å³¶ä¸Šç¬¬äºŒå¤§åŸé®ã€‚", nav: "Qalansiyah" }
                ]
            },
            {
                date: "2/23 (ä¸€)", title: "å‘Šåˆ¥ç´¢ç§‘ç‰¹æ‹‰", location: "Dubai",
                items: [
                    { type: "activity", time: "Morning", title: "Lagoon æ—¥å‡º", desc: "æœ€å¾Œä¸€æ¬¡æ—¥å‡ºï¼Œæ‰“åŒ…è¡Œæã€‚é€”ä¸­ç¶“éäºŒæˆ°ä¿„ç¾…æ–¯å¦å…‹éºè·¡æ‹ç…§ã€‚", nav: "Detwah Lagoon" },
                    { type: "flight", time: "10:30", title: "IY526 èµ·é£›", desc: "é£›å›å‰é”è½‰æ©Ÿ", nav: "Socotra Airport" },
                    { type: "stay", time: "20:45", title: "æŠµé”æœæ‹œ", desc: "å…¥ä½ Grande Signature Apartments (Downtown)", nav: "Grande Signature Apartments Dubai" }
                ]
            },
            {
                date: "2/24 (äºŒ)", title: "é˜¿å¸ƒé”æ¯”ä¸€æ—¥éŠ", location: "AbuDhabi",
                items: [
                    { type: "activity", time: "Morning", title: "è¬èµ«æ‰è€¶å¾·å¤§æ¸…çœŸå¯º", desc: "ä¸–ç•Œæœ€ç¾æ¸…çœŸå¯ºä¹‹ä¸€ã€‚<br><span class='highlight-box'><span class='tag must'>æ³¨æ„</span>æœè£éœ€å®Œå…¨é®è“‹æ‰‹è‡‚èˆ‡è…¿éƒ¨ï¼Œå¥³æ€§éœ€åŒ…é ­å·¾ã€‚</span>", nav: "Sheikh Zayed Grand Mosque" },
                    { type: "activity", time: "Noon", title: "é˜¿å¸ƒé”æ¯”ç¾…æµ®å®®", desc: "æ¬£è³å…‰ä¹‹é›¨ç©¹é ‚å»ºç¯‰ã€‚", nav: "Louvre Abu Dhabi" },
                    { type: "activity", time: "15:00", title: "é¨é¦¬é«”é©—", desc: "æ²™æ¼ æˆ–æµ·ç˜é¨é¦¬ã€‚", nav: "Abu Dhabi Horse Riding" },
                    { type: "food", time: "Dinner", title: "Time Out Market", desc: "ä½æ–¼æœæ‹œï¼Œæ™šé¤å¾Œè§€è³å“ˆé‡Œç™¼å¡”æ°´èˆç§€ã€‚", nav: "Time Out Market Dubai" }
                ]
            },
            {
                date: "2/25 (ä¸‰)", title: "æœæ‹œåŸå¸‚æ¢ç´¢", location: "Dubai",
                items: [
                    { type: "activity", time: "Morning", title: "èˆŠåŸå€æ•£æ­¥", desc: "Al Fahidi æ­·å²è¡—å€ã€æ­ä¹˜ Abra èˆ¹ã€é»ƒé‡‘é¦™æ–™å¸‚é›†ã€‚", nav: "Al Fahidi Historical District" },
                    { type: "activity", time: "Afternoon", title: "å“ˆé‡Œç™¼å¡” 124F", desc: "ç™»ä¸Šä¸–ç•Œæœ€é«˜æ¨“å±•æœ›å°ã€‚", nav: "Burj Khalifa" },
                    { type: "activity", time: "Evening", title: "æ²™æ¼ è¡æ²™ + æ™šé¤ç§€", desc: "Desert Safari é«”é©—ã€‚", nav: null }
                ]
            },
            {
                date: "2/26 (å››)", title: "è¿”ç¨‹", location: "Dubai",
                items: [
                    { type: "flight", time: "08:45", title: "EK386 èµ·é£›", desc: "å†è¦‹æœæ‹œï¼Œè¿”å›æº«æš–çš„å®¶ã€‚", nav: "Dubai International Airport Terminal 3" }
                ]
            }
        ];

        const packingList = {
            "éš¨èº«è¡Œæ (7kg)": ["è­·ç…§", "ç°½è­‰å½±æœ¬", "æ©Ÿç¥¨è¡Œç¨‹å–®", "éŒ¢åŒ… (ç¾é‡‘æ–°éˆ”)", "è¡Œå‹•é›»æº (éœ€éš¨èº«)", "ç›¸æ©Ÿ/é¡é ­", "å€‹äººè—¥å“"],
            "æ‰˜é‹è¡Œæ (23kg)": ["ç›¥æ´—ç”¨å“ (ç´¢ç§‘ç‰¹æ‹‰éœ²ç‡Ÿç”¨)", "å¿«ä¹¾æ¯›å·¾", "é˜²èšŠæ¶² (é‡è¦)", "é«˜ä¿‚æ•¸é˜²æ›¬ä¹³", "æšˆè»Šè—¥", "è½‰æ›æ’é ­ (Type G UK)", "å……é›»ç·šæ"],
            "è¡£ç‰©è£å‚™": ["æ³³è¡£/æ°´æ¯è¡£", "å¥½èµ°çš„å¥è¡Œé‹", "æ¶¼é‹/æ‹–é‹", "è–„å¤–å¥— (æ²™æ¼ æ—¥å¤œæº«å·®å¤§)", "å¤ªé™½çœ¼é¡", "é®é™½å¸½", "é•·è£™/é•·è¤² (æ¸…çœŸå¯ºç”¨)"],
            "å…¶ä»–": ["é ­ç‡ˆ (Headlamp) - éœ²ç‡Ÿå¿…å‚™", "æ¿•ç´™å·¾ (å¤§é‡)", "é˜²æ°´è¢‹ (Dry bag)", "ç’°ä¿æ°´ç“¶", "é›¶é£Ÿ/èƒ½é‡æ£’"]
        };

        // --- FUNCTIONS ---

        function init() {
            renderTimeline();
            renderFlights();
            renderStays();
            renderChecklist();
            restoreChecklistState();
        }

        // Weather Fetcher
        async function fetchWeather(city, elementId) {
            if (!coords[city]) return;
            const { lat, lon } = coords[city];
            try {
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                const data = await res.json();
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                
                // Simple Weather Icons
                let icon = "â˜€ï¸";
                if (code > 3) icon = "â˜ï¸"; 
                if (code > 45) icon = "ğŸŒ«ï¸";
                if (code > 50) icon = "ğŸŒ§ï¸";
                if (code > 80) icon = "â›ˆï¸";

                document.getElementById(elementId).innerHTML = `${icon} ${temp}Â°C`;
            } catch (e) {
                console.log("Weather fetch failed", e);
                document.getElementById(elementId).innerText = "N/A";
            }
        }

        // Timeline Renderer
        function renderTimeline() {
            const container = document.getElementById('tab-timeline');
            let html = '';
            
            itinerary.forEach((day, index) => {
                const weatherId = `w-${index}`;
                // Trigger weather fetch async
                fetchWeather(day.location, weatherId);

                let itemsHtml = day.items.map(item => `
                    <div class="card ${item.type}">
                        <div class="card-meta">
                            <span>${item.time}</span>
                            <span>${item.type.toUpperCase()}</span>
                        </div>
                        <div class="card-title">${item.title}</div>
                        <div class="card-desc">${item.desc}</div>
                        ${item.nav ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.nav)}" target="_blank" class="btn-nav">ğŸ“ å°èˆª</a>` : ''}
                    </div>
                `).join('');

                html += `
                    <div class="day-container">
                        <div class="day-header">
                            <div class="day-date">${day.date} ${day.title}</div>
                            <div class="day-weather" id="${weatherId}"><span style="font-size:10px">Loading</span></div>
                        </div>
                        ${itemsHtml}
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // Info Tab Renderers
        function renderFlights() {
            const list = document.getElementById('flight-list');
            list.innerHTML = flights.map(f => `
                <div class="flight-card">
                    <div class="flight-header">
                        <span class="flight-route">${f.route}</span>
                        <span class="flight-date">${f.date}</span>
                    </div>
                    <div class="flight-detail-row">
                        <div>
                            <div class="flight-label">Flight No.</div>
                            <div class="flight-time" style="color:var(--accent-blue)">${f.no}</div>
                        </div>
                        <div style="text-align:center">
                            <div class="flight-label">Dep</div>
                            <div class="flight-time">${f.dep}</div>
                        </div>
                        <div style="text-align:right">
                            <div class="flight-label">Arr</div>
                            <div class="flight-time">${f.arr}</div>
                        </div>
                        ${f.term !== '-' ? `<div style="text-align:right"><div class="flight-label">Term</div><div class="flight-time">${f.term}</div></div>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function renderStays() {
            const list = document.getElementById('stay-list');
            list.innerHTML = stays.map(s => `
                <div class="card stay">
                    <div class="card-title">${s.name}</div>
                    <div class="card-desc">${s.addr}</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.map)}" target="_blank" class="btn-nav">ğŸ“ æŸ¥çœ‹åœ°åœ–</a>
                </div>
            `).join('');
        }

        // Checklist Logic
        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            let html = '';
            for (const [category, items] of Object.entries(packingList)) {
                html += `<div class="check-group"><div class="check-title">${category}</div>`;
                items.forEach((item, i) => {
                    const id = `chk-${category}-${i}`;
                    html += `
                        <div class="check-item" id="${id}" onclick="toggleCheck('${id}')">
                            <div class="checkbox"></div>
                            <span>${item}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            container.innerHTML = html;
        }

        function toggleCheck(id) {
            const el = document.getElementById(id);
            el.classList.toggle('checked');
            saveChecklistState();
        }

        function saveChecklistState() {
            const checkedIds = [];
            document.querySelectorAll('.check-item.checked').forEach(el => {
                checkedIds.push(el.id);
            });
            localStorage.setItem('tripChecklist', JSON.stringify(checkedIds));
        }

        function restoreChecklistState() {
            const saved = JSON.parse(localStorage.getItem('tripChecklist'));
            if (saved) {
                saved.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.classList.add('checked');
                });
            }
        }

        // Tab Switching
        function switchTab(tabId, navEl) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.getElementById(`tab-${tabId}`).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            navEl.classList.add('active');

            window.scrollTo(0,0);
        }

        // Run
        init();

    </script>
</body>
</html>
