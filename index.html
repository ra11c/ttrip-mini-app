<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ëä±Â§©Judy ÔΩúQuick Travel Guide</title>
    <style>
        :root {
            /* Êó•ÂºèÊ•µÁ∞°ÈÖçËâ≤: ÂíåÁ¥ô„ÄÅÂ¢®„ÄÅÊ≤ôÊº†„ÄÅ‰πæÁá•Ëä± */
            --bg-color: #F9F9F7;
            --card-bg: #FFFFFF;
            --text-main: #333333;
            --text-light: #888888;
            --accent-primary: #BFA588; /* Ê≤ôÊº†Èáë */
            --accent-secondary: #D48888; /* Ëä±Â§©Á≤â */
            --accent-ocean: #7FA3B5; /* Á¥¢ÁßëÁâπÊãâËóç */
            --nav-bg: rgba(255, 255, 255, 0.96);
            --border-radius: 16px;
            --shadow: 0 4px 20px rgba(0,0,0,0.03);
            --font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang TC", "Microsoft JhengHei", sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-family);
            margin: 0;
            padding: 0;
            padding-bottom: 100px; /* Â∫ïÈÉ®Â∞éËà™Á©∫Èñì */
            line-height: 1.6;
        }

        /* Header */
        header {
            background: var(--bg-color);
            padding: 50px 24px 10px 24px;
            position: sticky;
            top: 0;
            z-index: 10;
            backdrop-filter: blur(5px);
        }

        h1 { margin: 0; font-size: 24px; font-weight: 700; letter-spacing: 1px; color: var(--text-main); }
        .subtitle { font-size: 13px; color: var(--accent-primary); letter-spacing: 2px; text-transform: uppercase; margin-top: 5px; display: block; }

        /* Sections */
        .section { display: none; padding: 10px 20px; animation: fadeIn 0.4s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Timeline Card Design */
        .date-header {
            margin: 30px 0 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .date-title { font-size: 18px; font-weight: 700; }
        .weather-badge {
            font-size: 12px;
            color: var(--text-light);
            background: #EFEFED;
            padding: 4px 10px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 18px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            position: relative;
            border-left: 3px solid transparent;
            transition: transform 0.1s;
        }
        .card:active { transform: scale(0.99); }

        /* Card Categories */
        .card.transport { border-left-color: #A0A0A0; }
        .card.stay { border-left-color: var(--accent-primary); }
        .card.food { border-left-color: var(--accent-secondary); }
        .card.activity { border-left-color: var(--accent-ocean); }

        .card-time { font-size: 13px; color: var(--accent-primary); font-weight: 600; font-family: monospace; display: block; margin-bottom: 4px; }
        .card-title { font-size: 16px; font-weight: 600; margin-bottom: 8px; line-height: 1.4; }
        .card-desc { font-size: 14px; color: #666; margin-bottom: 12px; white-space: pre-line; }

        /* Highlight Tags */
        .highlight { font-weight: 600; color: var(--accent-secondary); background: #FFF0F0; padding: 0 4px; border-radius: 4px; }
        .tag-info { font-weight: 600; color: var(--accent-ocean); background: #F0F8FF; padding: 0 4px; border-radius: 4px; }

        /* Navigation Button */
        .btn-nav {
            display: inline-flex;
            align-items: center;
            background: #F4F4F4;
            color: var(--text-main);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            text-decoration: none;
            gap: 4px;
        }
        .btn-nav:hover { background: #EAEAEA; }

        /* Flight & Info Cards */
        .info-group { margin-bottom: 30px; }
        .info-title { font-size: 14px; color: var(--text-light); margin-bottom: 10px; font-weight: 600; letter-spacing: 1px; }
        .flight-row {
            display: grid;
            grid-template-columns: 0.8fr 1.5fr 1fr;
            padding: 12px 0;
            border-bottom: 1px solid #F0F0F0;
            font-size: 14px;
        }
        .flight-row:last-child { border-bottom: none; }
        .flight-code { color: var(--accent-primary); font-weight: 600; }

        /* Checklist */
        .check-group { margin-bottom: 25px; }
        .check-header { font-size: 15px; font-weight: 700; color: var(--accent-ocean); margin-bottom: 10px; border-bottom: 2px solid #F0F8FF; padding-bottom: 5px; display: inline-block; }
        
        .check-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f9f9f9;
            cursor: pointer;
            transition: all 0.2s;
        }
        .checkbox {
            width: 20px; height: 20px;
            border: 1.5px solid #CCC;
            border-radius: 50%;
            margin-right: 12px;
            display: flex; align-items: center; justify-content: center;
        }
        .check-item.checked .checkbox { background: var(--accent-secondary); border-color: var(--accent-secondary); }
        .check-item.checked .checkbox::after { content: '‚úì'; color: white; font-size: 12px; }
        .check-item.checked span { color: #CCC; text-decoration: line-through; }

        /* Bottom Nav */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0; right: 0;
            background: var(--nav-bg);
            border-top: 1px solid rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-around;
            padding: 12px 0 24px 0; /* Extra padding for iOS home bar */
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        .nav-item {
            text-align: center;
            font-size: 10px;
            color: #BBB;
            cursor: pointer;
            flex: 1;
            transition: color 0.2s;
        }
        .nav-item.active { color: var(--text-main); font-weight: 600; }
        .nav-icon { font-size: 20px; display: block; margin-bottom: 4px; }

    </style>
</head>
<body>

    <header>
        <h1>Ëä±Â§©Judy</h1>
        <span class="subtitle">Quick Travel Guide</span>
    </header>

    <div id="tab-timeline" class="section active">
        <div id="timeline-container"></div>
    </div>

    <div id="tab-info" class="section">
        <div class="info-group">
            <div class="info-title">‚úàÔ∏è FLIGHTS</div>
            <div class="card">
                <div id="flights-container"></div>
            </div>
        </div>

        <div class="info-group">
            <div class="info-title">üè® ACCOMMODATION</div>
            <div id="hotels-container"></div>
        </div>

        <div class="info-group">
            <div class="info-title">üó∫Ô∏è MAP</div>
            <div class="card">
                <div class="card-title">ÊôØÈªûÂú∞Âúñ</div>
                <div class="card-desc">Â∑≤ÁÇ∫ÊÇ®Ê®ôË®òË°åÁ®ãÈáçÈªû‰ΩçÁΩÆ„ÄÇ</div>
                <a href="https://www.google.com/maps/search/?api=1&query=Dubai+Socotra" target="_blank" class="btn-nav" style="width:100%; justify-content:center;">ÈñãÂïü Google Maps</a>
            </div>
        </div>
    </div>

    <div id="tab-checklist" class="section">
        <div id="checklist-container"></div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('timeline', this)">
            <span class="nav-icon">üìÖ</span>Ë°åÁ®ã
        </div>
        <div class="nav-item" onclick="switchTab('info', this)">
            <span class="nav-icon">üé´</span>Ë≥áË®ä
        </div>
        <div class="nav-item" onclick="switchTab('checklist', this)">
            <span class="nav-icon">üéí</span>ÊâìÂåÖ
        </div>
    </nav>

    <script>
        // --- DATA ---
        
        const tripData = {
            flights: [
                {date: "2/15", code: "EK367", route: "TPE ‚Üí DXB", time: "23:00 - 04:50", term: "T3"},
                {date: "2/16", code: "XY502", route: "DXB ‚Üí JED", time: "12:20 - 14:45", term: "T1"},
                {date: "2/17", code: "IY525", route: "JED ‚Üí SCT", time: "11:00 - 14:30", term: "-"},
                {date: "2/23", code: "IY526", route: "SCT ‚Üí JED", time: "10:30 - 14:00", term: "-"},
                {date: "2/23", code: "XY505", route: "JED ‚Üí DXB", time: "17:00 - 20:45", term: "-"},
                {date: "2/26", code: "EK386", route: "DXB ‚Üí TPE", time: "08:45 - 20:40", term: "T3"}
            ],
            hotels: [
                {name: "Best Western Plus Jeddah", addr: "Madinah Road, Jeddah", desc: "ÈÑ∞ËøëÊø±Êµ∑Ë∑Ø"},
                {name: "Socotra Campsites", addr: "Socotra Island", desc: "Erisel / Fermhin / Detwah (Private Tents)"},
                {name: "Grande Signature Apartments", addr: "Downtown Dubai", desc: "ÊùúÊãúÂ∏Ç‰∏≠ÂøÉ"}
            ],
            itinerary: [
                {
                    date: "2/15 (Êó•)", loc: "Taipei", lat: 25.07, lon: 121.23,
                    items: [
                        {type: "transport", time: "23:00", title: "EK367 Ëµ∑È£õ", desc: "ÂâçÂæÄÊùúÊãú | È£õË°åÊôÇÈñìÁ¥Ñ 10hr", nav: "Taoyuan International Airport"}
                    ]
                },
                {
                    date: "2/16 (‰∏Ä)", loc: "Jeddah", lat: 21.54, lon: 39.17,
                    items: [
                        {type: "transport", time: "04:50", title: "ÊäµÈÅîÊùúÊãú", desc: "ËΩâÊ©üÁ≠âÂæÖ (DXB)"},
                        {type: "transport", time: "12:20", title: "È£õÂæÄÂêâÈÅî", desc: "XY502 | ÊäµÈÅîÂæåÂÖ•Â¢ÉÊ≤ôÁÉèÂú∞"},
                        {type: "stay", time: "16:00", title: "Check-in", desc: "Best Western Plus Jeddah Hotel", nav: "Best Western Plus Jeddah Hotel Madinah Road"},
                        {type: "food", time: "Night", title: "Waterfront Dinner", desc: "ÂêâÈÅîÊø±Êµ∑Ë∑ØÊï£Ê≠•ËàáÊôöÈ§ê", nav: "Jeddah Corniche"}
                    ]
                },
                {
                    date: "2/17 (‰∫å)", loc: "Socotra", lat: 12.6, lon: 54.0,
                    items: [
                        {type: "transport", time: "11:00", title: "È£õÂæÄÁ¥¢ÁßëÁâπÊãâ", desc: "IY525 (JED -> SCT)"},
                        {type: "activity", time: "14:30", title: "Majestic White Dunes", desc: "ÊäµÈÅîÔºåÊê≠‰πò4x4ÂâçÂæÄÊù±ÈÉ®„ÄÇÈÄîÁ∂ìÈ¶ñÈÉΩ HadiboÔºåÈÅ†Áú∫ Hajhair Â±±ËÑà„ÄÇ"},
                        {type: "stay", time: "Night", title: "Erisel Beach Èú≤Ááü", desc: "Á¨¨‰∏ÄÊôöÊµ∑ÁÅòÁßÅ‰∫∫Â∏≥ÁØ∑Ôºå‰∫´ÂèóÊòüÁ©∫„ÄÇ", nav: "Arher Beach"}
                    ]
                },
                {
                    date: "2/18 (‰∏â)", loc: "Socotra", lat: 12.6, lon: 54.0,
                    items: [
                        {type: "activity", time: "Sunrise", title: "Arher Sand Dunes", desc: "ÂøÖÁúãÊó•Âá∫ÔºÅÁà¨‰∏äÂ∑®Â§ßÊ≤ô‰∏ò„ÄÅÊªëÊ≤ô„ÄÇÊó©È§êÊôÇÁïôÊÑèÊµ∑Ë±ö (Spinner Dolphins)„ÄÇ", nav: "Arher Beach"},
                        {type: "activity", time: "Day", title: "Dihamri Êµ∑Ê¥ã‰øùË≠∑ÂçÄ", desc: "ÊµÆÊΩõÁÜ±Èªû (Snorkeling)ÔºåË±êÂØåÁèäÁëöËàáÈ≠öÁæ§„ÄÇ‰∫´Áî®ÂçàÈ§ê„ÄÇ", nav: "Dihamri Marine Protected Area"},
                        {type: "activity", time: "PM", title: "Homhil ÁÑ°ÈÇäÈöõÊ≥≥Ê±†", desc: "ÁµïÁæéÂ§©ÁÑ∂Ê≥≥Ê±† (Infinity Pool)ÔºåÁú∫ÊúõÂåóÂ≤∏„ÄÇÊ≤øÈÄîÂèØË¶ãÁì∂Â≠êÊ®πËàáÈæçË°ÄÊ®π„ÄÇ", nav: "Homhil Protected Area"},
                        {type: "stay", time: "Night", title: "Erisel Beach Èú≤Ááü", desc: "ËøîÂõûÊù±Â≤∏ÁáüÂú∞ÈÅéÂ§ú„ÄÇ"}
                    ]
                },
                {
                    date: "2/19 (Âõõ)", loc: "Socotra", lat: 12.5, lon: 53.9,
                    items: [
                        {type: "activity", time: "AM", title: "Kaleesan White Canyon", desc: "ÁôΩËâ≤Â≥ΩË∞∑ËàáËîöËóçÊ±†Ê∞¥ÔºåÈÅ©ÂêàÊ∏∏Ê≥≥Ë∑≥Ê∞¥„ÄÇ", nav: "Wadi Kalisan"},
                        {type: "activity", time: "PM", title: "Zahek Desert & Camel", desc: "Ê≤ôÊº†Êº´Ê≠•ËàáÈ®éÈß±ÈßùÔºåÈ´îÈ©óÈòøÊãâ‰ºØ‰πãÂ§úÊ∞õÂúç„ÄÇ", nav: "Zahek Dunes"},
                        {type: "activity", time: "Stop", title: "Digub Cave", desc: "Â∑®Â§ßÊ¥ûÁ©¥Ôºå‰øØÁû∞ÂçóÂ≤∏ÁæéÊôØ„ÄÇ", nav: "Digub Cave"},
                        {type: "stay", time: "Night", title: "Fermhin Forest Camp", desc: "ÂâçÂæÄ Dixam È´òÂéüÔºåÂú®‰∏ñÁïåÊúÄÂ§ßÈæçË°ÄÊ®πÊ£ÆÊûó‰∏≠Èú≤Ááü„ÄÇ", nav: "Fermhin Forest"}
                    ]
                },
                {
                    date: "2/20 (‰∫î)", loc: "Socotra", lat: 12.5, lon: 53.9,
                    items: [
                        {type: "activity", time: "AM", title: "ÈæçË°ÄÊ®πÊ£ÆÊûóÊó•Âá∫", desc: "Êé¢Á¥¢ÁâπÊúâÁ®ÆÂãïÊ§çÁâ©Ôºå‰∫´ÂèóÈ≠îÂπªÊôÇÂàª„ÄÇ"},
                        {type: "activity", time: "PM", title: "ÊãúË®™ Bedouin ÊùëËêΩ", desc: "È´îÈ©óÁï∂Âú∞ÁîüÊ¥ªÔºåÂèÉËßÄÈæçË°ÄÊ®πËãóÂúÉ (‰øùËÇ≤ÂçÄ)„ÄÇ"},
                        {type: "stay", time: "Night", title: "Fermhin Forest Camp", desc: "ÁπºÁ∫åÂú®ÈæçË°ÄÊ®πÊ£ÆÊûó‰∏≠Èú≤Ááü„ÄÇ"}
                    ]
                },
                {
                    date: "2/21 (ÂÖ≠)", loc: "Socotra", lat: 12.6, lon: 53.5,
                    items: [
                        {type: "activity", time: "Day", title: "Detwah Lagoon", desc: "ÂøÖË®™ËóçËâ≤ÊΩüÊπñÔºÅÁôΩÊ≤ôËàáËóçÊ∞¥ÁöÑÊ•µËá¥Â∞çÊØî„ÄÇ", nav: "Detwah Lagoon"},
                        {type: "activity", time: "Sunset", title: "ÊΩüÊπñÂ±±È†ÇÊó•ËêΩ", desc: "Áà¨‰∏äÂ±±‰∏òÂ∞ãÊâæÂ≠§Áç®Áì∂Â≠êÊ®πÔºå‰øØÁû∞ÂÖ®ÊôØ„ÄÇ"},
                        {type: "stay", time: "Night", title: "Detwah Lagoon Camp", desc: "ÊΩüÊπñÊóÅÂ∞àÂ±¨ÁáüÂú∞„ÄÇ"}
                    ]
                },
                {
                    date: "2/22 (Êó•)", loc: "Socotra", lat: 12.6, lon: 53.5,
                    items: [
                        {type: "activity", time: "AM", title: "Shoab Golden Beach", desc: "Êê≠ËàπÂâçÂæÄÈªÉÈáëÊµ∑ÁÅòÔºåÂ∞ãÊâæË∑≥Ë∫çÁöÑÊµ∑Ë±ö (Spinner Dolphins)„ÄÇ", nav: "Shoab Beach"},
                        {type: "activity", time: "Relax", title: "Êµ∑ÁÅòÊôÇÂÖâ", desc: "Ê∏∏Ê≥≥„ÄÅÊîæÈ¨Ü„ÄÇ‰∏ãÂçàÂèÉËßÄ Qalansiyah Â∞èÈéÆ„ÄÇ", nav: "Qalansiyah"},
                        {type: "stay", time: "Night", title: "Detwah Lagoon Camp", desc: "ÊúÄÂæå‰∏ÄÊôöÈú≤Ááü„ÄÇ"}
                    ]
                },
                {
                    date: "2/23 (‰∏Ä)", loc: "Dubai", lat: 25.2, lon: 55.27,
                    items: [
                        {type: "activity", time: "AM", title: "ÂëäÂà•Á¥¢ÁßëÁâπÊãâ", desc: "ÈÄîÁ∂ì‰∫åÊà∞‰øÑÁæÖÊñØÂù¶ÂÖãÈÅ∫Ë∑°ÊãçÁÖß„ÄÇÂâçÂæÄÊ©üÂ†¥„ÄÇ", nav: "Russian Tanks Socotra"},
                        {type: "transport", time: "10:30", title: "SCT ‚Üí JED ‚Üí DXB", desc: "Êº´Èï∑ÁöÑËΩâÊ©üË°åÁ®ã"},
                        {type: "transport", time: "20:45", title: "ÊäµÈÅîÊùúÊãú", desc: "Êé•Ê©üÂâçÂæÄÂ∏ÇÂçÄ"},
                        {type: "stay", time: "Night", title: "Check-in", desc: "Grande Signature Apartments", nav: "Grande Signature Apartments Dubai"}
                    ]
                },
                {
                    date: "2/24 (‰∫å)", loc: "Abu Dhabi", lat: 24.45, lon: 54.37,
                    items: [
                        {type: "activity", time: "AM", title: "Â§ßÊ∏ÖÁúüÂØ∫", desc: "Sheikh Zayed Grand Mosque„ÄÇÊ≥®ÊÑèÊúçË£ùÔºÅ", nav: "Sheikh Zayed Grand Mosque"},
                        {type: "activity", time: "Noon", title: "ÁæÖÊµÆÂÆÆÂçöÁâ©È§®", desc: "Louvre Abu Dhabi„ÄÇ", nav: "Louvre Abu Dhabi"},
                        {type: "activity", time: "PM", title: "È®éÈ¶¨È´îÈ©ó", desc: "‰∏ãÂçàÊ¥ªÂãï"},
                        {type: "food", time: "Dinner", title: "Time Out Market", desc: "ÊôöÈ§êËàáÂìàÈáåÁôºÂ°îÊ∞¥ËàûÁßÄ", nav: "Time Out Market Dubai"}
                    ]
                },
                {
                    date: "2/25 (‰∏â)", loc: "Dubai", lat: 25.2, lon: 55.27,
                    items: [
                        {type: "activity", time: "Day", title: "ÊùúÊãúÂüéÂ∏ÇÈ´îÈ©ó", desc: "ËàäÂüéÂçÄÊï£Ê≠•„ÄÅÂìàÈáåÁôºÂ°î 124F Â±ïÊúõÂè∞„ÄÇ", nav: "Burj Khalifa"},
                        {type: "food", time: "PM", title: "Ê≤ôÊº†ÊôöÈ§ê", desc: "Desert Safari„ÄÇÈÄ£ÁµêÔºöNoble Life", nav: null}
                    ]
                },
                {
                    date: "2/26 (Âõõ)", loc: "Taipei", lat: 25.0, lon: 121.5,
                    items: [
                        {type: "transport", time: "08:45", title: "EK386 Ëµ∑È£õ", desc: "ËøîÂõûÁîúËúúÁöÑÂÆ∂"},
                        {type: "transport", time: "20:40", title: "ÊäµÈÅîÂè∞Âåó", desc: "ÊóÖÁ®ãÁµêÊùü"}
                    ]
                }
            ],
            checklist: {
                "Èö®Ë∫´ÂåÖ": ["ÊâãÊ©ü", "Ë≠∑ÁÖß", "Visa (Á¥ôÊú¨+ÊâãÊ©ü)", "Ê©üÁ•®/ÈõªÂ≠êÁ•®", "Drone permit", "ÊóÖÈÅä‰øùÈö™Ë≥áÊñô", "‰ø°Áî®Âç°", "ÁæéÈáëÁèæÈáë (Êñ∞Èàî)", "Â∞èË≤ª $150-250", "Á∑äÊÄ•ÂÇôÁî® $600+", "Ë°åÂãïÈõªÊ∫ê", "ÂÖÖÈõªÁ∑ö", "ËΩâÊé•È†≠ (Type G)", "ËÄ≥Ê©ü", "È†∏Êûï/ÁúºÁΩ©/ËÄ≥Â°û", "Ë≠∑ÂîáËÜè", "‰øùÊøïÂô¥Èúß/Èù¢ËÜú", "Èö±ÂΩ¢ÁúºÈè°+Ëó•Ê∞¥", "ÁúºÈè°", "Ë®òÊÜ∂Âç°", "Á≠Ü"],
                "Ë°£Áâ©": ["‰∏äË°£ x3-4", "Áü≠Ë§≤/legging", "Èï∑Ë§≤ x1", "Áù°Ë°£", "ÂÖßË°£Ë§≤ x6-7", "Ê≥≥Ë°£", "Â•≥ÁîüÈï∑Ë£ô/Èï∑Ë§≤ (Ê∏ÖÁúüÂØ∫Áî®)", "ËñÑÂ§ñÂ•ó"],
                "ÈûãÂ≠ê": ["ÂÅ•Ë°åÈûã", "Ê∂ºÈûã/ÊãñÈûã"],
                "Èò≤Êõ¨ & Êà∂Â§ñ": ["Â§™ÈôΩÁúºÈè°", "Â∏ΩÂ≠ê/ÊºÅÂ§´Â∏Ω", "SPF50 Èò≤Êõ¨ (ÁèäÁëöÂèãÂñÑ)", "Êõ¨Âæå‰øÆÂæ©/ËòÜËñà", "Èò≤Êõ¨Â§ñÂ•ó/UVÁΩ©Ë°´", "Ê∞¥ÊØçË°£/Èï∑Ë¢ñÊ≥≥Ë°£"],
                "Èú≤ÁáüËàáÁîüÊ¥ª": ["È†≠Ááà", "Âø´‰πæÊØõÂ∑æ", "ÊøïÁ¥ôÂ∑æ (Â§ßÈáè)", "‰πæÊ¥óÊâã", "Áõ•Ê¥óÁî®ÂìÅ", "‰øùÊøï‰π≥Ê∂≤", "Â∞èÈÜ´Ëó•ÂåÖ", "Ê∞¥Â£∫"],
                "ÈõªÂ≠ê / ÊîùÂΩ±": ["Ë°åÂãïÈõªÊ∫ê x2-3", "Âª∂Èï∑Á∑ö", "Áõ∏Ê©ü+ÈõªÊ±†", "Drone+ÂÇôÈõª", "Èò≤Ê∞¥Ë¢ã/Èò≤Ê≤ôË¢ã"],
                "ÂÖ∂‰ªñ": ["Èò≤Â°µÂè£ÁΩ©/Buff", "Èõ∂È£ü/ËÉΩÈáèÊ£í", "Á©∫Ë≥ºÁâ©Ë¢ã"]
            }
        };

        // --- LOGIC ---

        function init() {
            renderTimeline();
            renderInfo();
            renderChecklist();
        }

        // 1. Weather API
        async function fetchWeather(lat, lon, elementId) {
            try {
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                const data = await res.json();
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                let icon = "‚òÄÔ∏è";
                if(code > 3) icon = "‚òÅÔ∏è";
                if(code > 60) icon = "üåßÔ∏è";
                document.getElementById(elementId).innerHTML = `${icon} ${temp}¬∞C`;
            } catch {
                document.getElementById(elementId).innerHTML = "üå§Ô∏è";
            }
        }

        // 2. Smart Highlighter
        function highlightText(text) {
            const rules = [
                { regex: /(Êó•Âá∫|Sunrise|Sunset|Êµ∑Ë±ö|Dolphins)/gi, class: "highlight" },
                { regex: /(ÂøÖÊãç|ÂøÖÁúã|ÂøÖË®™|ÁµïÁæé|‰∏ñÁïåÈÅ∫Áî¢)/g, class: "highlight" },
                { regex: /(Ë≠∑ÁÖß|Visa|ÁèæÈáë|ÁæéÈáë|ËΩâÊé•È†≠)/g, class: "tag-info" },
                { regex: /(Ê≥®ÊÑè|ÊúçË£ù|Èï∑Ë§≤|Èï∑Ë£ô)/g, class: "tag-info" }
            ];
            
            let newText = text;
            rules.forEach(rule => {
                newText = newText.replace(rule.regex, (match) => `<span class="${rule.class}">${match}</span>`);
            });
            return newText;
        }

        // 3. Render Timeline
        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            let html = '';

            tripData.itinerary.forEach((day, idx) => {
                const weatherId = `w-${idx}`;
                fetchWeather(day.lat, day.lon, weatherId);

                let itemsHtml = day.items.map(item => {
                    const navBtn = item.nav 
                        ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.nav)}" target="_blank" class="btn-nav">üìç Â∞éËà™</a>` 
                        : '';
                    
                    return `
                        <div class="card ${item.type}">
                            <span class="card-time">${item.time}</span>
                            <div class="card-title">${item.title}</div>
                            <div class="card-desc">${highlightText(item.desc)}</div>
                            ${navBtn}
                        </div>
                    `;
                }).join('');

                html += `
                    <div>
                        <div class="date-header">
                            <span class="date-title">${day.date}</span>
                            <span class="weather-badge" id="${weatherId}">Loading...</span>
                        </div>
                        ${itemsHtml}
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // 4. Render Info
        function renderInfo() {
            // Flights
            const flightsHtml = tripData.flights.map(f => `
                <div class="flight-row">
                    <span class="flight-code">${f.date}</span>
                    <span>${f.route}<br><small style="color:#999">${f.code}</small></span>
                    <div style="text-align:right">
                        <span>${f.time}</span><br>
                        <small>Term: ${f.term}</small>
                    </div>
                </div>
            `).join('');
            document.getElementById('flights-container').innerHTML = flightsHtml;

            // Hotels
            const hotelsHtml = tripData.hotels.map(h => `
                <div class="card stay">
                    <div class="card-title">${h.name}</div>
                    <div class="card-desc">${h.addr}<br><small>${h.desc}</small></div>
                    <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(h.name + " " + h.addr)}" target="_blank" class="btn-nav">üè® Â∞éËà™</a>
                </div>
            `).join('');
            document.getElementById('hotels-container').innerHTML = hotelsHtml;
        }

        // 5. Render Checklist
        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            let html = '';
            
            // Get saved state
            const savedState = JSON.parse(localStorage.getItem('judyTripChecklist')) || {};

            for (const [category, items] of Object.entries(tripData.checklist)) {
                html += `<div class="check-group"><div class="check-header">${category}</div>`;
                items.forEach(item => {
                    const isChecked = savedState[item] ? 'checked' : '';
                    html += `
                        <div class="check-item ${isChecked}" onclick="toggleCheck(this, '${item}')">
                            <div class="checkbox"></div>
                            <span>${highlightText(item)}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            container.innerHTML = html;
        }

        function toggleCheck(el, item) {
            el.classList.toggle('checked');
            const savedState = JSON.parse(localStorage.getItem('judyTripChecklist')) || {};
            
            if (el.classList.contains('checked')) {
                savedState[item] = true;
            } else {
                delete savedState[item];
            }
            localStorage.setItem('judyTripChecklist', JSON.stringify(savedState));
        }

        // Tab Switcher
        function switchTab(tabId, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            btn.classList.add('active');
            window.scrollTo(0,0);
        }

        init();
    </script>
</body>
</html>
