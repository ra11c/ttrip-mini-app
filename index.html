<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ëä±Â§©Judy ÔΩúQuick Travel Guide</title>
    <style>
        :root {
            /* Êó•ÂºèÊ•µÁ∞°ÈÖçËâ≤ */
            --bg-color: #F9F9F7;
            --card-bg: #FFFFFF;
            --text-main: #3E3E3E;
            --text-light: #949494;
            --accent-sand: #C5A065;
            --accent-pink: #D89F9F;
            --accent-blue: #7EA6B8;
            --accent-alert: #D35400;
            --border-radius: 16px;
            --shadow: 0 4px 20px rgba(0,0,0,0.05);
            --font-stack: -apple-system, BlinkMacSystemFont, "PingFang TC", "Microsoft JhengHei", sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-stack);
            margin: 0;
            padding: 0;
            padding-bottom: 100px;
        }

        /* HEADER */
        header {
            padding: 40px 24px 10px 24px;
            background: rgba(249, 249, 247, 0.95);
            position: sticky;
            top: 0;
            z-index: 50;
            backdrop-filter: blur(8px);
        }
        h1 { margin: 0; font-size: 22px; font-weight: 700; color: var(--text-main); }
        .subtitle { font-size: 12px; color: var(--accent-sand); letter-spacing: 1px; text-transform: uppercase; margin-top: 5px; font-weight: 600; }

        /* UP NEXT HERO CARD */
        .hero-section { padding: 10px 20px 20px 20px; }
        .hero-card {
            background: linear-gradient(135deg, #FFF 0%, #FFFDF5 100%);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 8px 24px rgba(197, 160, 101, 0.15);
            border-left: 5px solid var(--accent-sand);
            position: relative;
            overflow: hidden;
        }
        .hero-label { font-size: 11px; font-weight: 700; color: var(--accent-sand); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .hero-title { font-size: 18px; font-weight: 700; margin-bottom: 6px; color: var(--text-main); }
        .hero-time { font-size: 14px; color: var(--text-light); margin-bottom: 15px; display: flex; align-items: center; gap: 6px; }
        .countdown-badge {
            display: inline-block;
            background: var(--text-main);
            color: #FFF;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        /* SECTIONS */
        .section { display: none; padding: 10px 20px; animation: fadeIn 0.4s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* TIMELINE */
        .date-header { margin: 30px 0 15px 5px; font-size: 18px; font-weight: 700; display: flex; align-items: center; justify-content: space-between; }
        .weather-badge { font-size: 12px; font-weight: normal; background: #EEE; padding: 4px 10px; border-radius: 12px; color: #666; }
        
        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 18px;
            margin-bottom: 14px;
            box-shadow: var(--shadow);
            border-left: 3px solid #DDD;
        }
        .card.transport { border-left-color: #A0A0A0; }
        .card.stay { border-left-color: var(--accent-sand); }
        .card.food { border-left-color: var(--accent-pink); }
        .card.activity { border-left-color: var(--accent-blue); }

        .card-time { font-size: 12px; color: var(--accent-sand); font-weight: 700; display: block; margin-bottom: 4px; }
        .card-title { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
        .card-desc { font-size: 14px; color: #666; margin-bottom: 8px; line-height: 1.5; white-space: pre-line; }
        
        .btn-map {
            display: inline-flex; align-items: center;
            background: #F4F4F4; color: #333; padding: 6px 12px;
            border-radius: 8px; font-size: 12px; font-weight: 600; text-decoration: none; margin-top: 5px;
        }

        /* FLIGHT CARDS (NEW) */
        .luggage-alert {
            background: #FFF3E0; border: 1px solid #FFE0B2;
            color: #E65100; padding: 15px; border-radius: 12px;
            font-size: 13px; margin-bottom: 20px; font-weight: 600;
        }
        .flight-card {
            background: #FFF; border-radius: 16px; padding: 20px;
            margin-bottom: 20px; box-shadow: var(--shadow); position: relative;
        }
        .fc-header { display: flex; justify-content: space-between; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #F0F0F0; }
        .fc-airline { font-weight: 700; color: var(--accent-blue); font-size: 15px; }
        .fc-date { font-size: 13px; color: #999; }
        .fc-route { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .fc-city { font-size: 20px; font-weight: 800; color: var(--text-main); }
        .fc-arrow { color: var(--accent-sand); font-size: 18px; }
        .fc-times { display: flex; justify-content: space-between; font-family: monospace; font-size: 14px; color: #555; margin-bottom: 15px; }
        .fc-meta { background: #F9F9F9; padding: 10px; border-radius: 8px; font-size: 12px; color: #666; display: flex; justify-content: space-between; }
        .fc-link { display: block; text-align: center; margin-top: 15px; color: var(--accent-pink); font-size: 12px; text-decoration: none; font-weight: 600; }

        /* CHECKLIST PROGRESS (NEW) */
        .progress-box {
            background: #FFF; padding: 20px; margin: 0 20px 20px 20px;
            border-radius: 16px; box-shadow: var(--shadow);
        }
        .progress-text { display: flex; justify-content: space-between; font-size: 13px; font-weight: 700; margin-bottom: 8px; color: var(--text-main); }
        .progress-bar-bg { background: #EEE; height: 8px; border-radius: 4px; overflow: hidden; }
        .progress-bar-fill { background: var(--accent-pink); height: 100%; width: 0%; transition: width 0.3s ease; }

        .check-group { margin-bottom: 25px; }
        .check-title { font-size: 14px; font-weight: 700; color: var(--accent-sand); margin-bottom: 10px; }
        .check-item { display: flex; align-items: center; padding: 12px 0; border-bottom: 1px solid #F5F5F5; cursor: pointer; }
        .checkbox { width: 20px; height: 20px; border: 1.5px solid #CCC; border-radius: 50%; margin-right: 12px; display: flex; align-items: center; justify-content: center; }
        .check-item.checked .checkbox { background: var(--accent-pink); border-color: var(--accent-pink); }
        .check-item.checked .checkbox::after { content: '‚úì'; color: white; font-size: 12px; }
        .check-item.checked span { text-decoration: line-through; color: #CCC; }

        /* BOTTOM NAV */
        .bottom-nav {
            position: fixed; bottom: 0; width: 100%;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px); border-top: 1px solid #EEE;
            display: flex; padding: 10px 0 25px 0; z-index: 100;
        }
        .nav-item { flex: 1; text-align: center; font-size: 10px; color: #CCC; cursor: pointer; }
        .nav-item.active { color: var(--text-main); font-weight: 700; }
        .nav-icon { font-size: 22px; display: block; margin-bottom: 3px; }

        /* Highlights */
        .hl { font-weight: 600; color: var(--accent-alert); }
    </style>
</head>
<body>

    <header>
        <h1>Ëä±Â§©Judy</h1>
        <span class="subtitle">Middle East 2026 Travel Guide</span>
    </header>

    <div id="tab-timeline" class="section active">
        <div id="hero-container" class="hero-section">
            <div class="hero-card">
                <div class="hero-label">UP NEXT ‰∏ã‰∏ÄÂÄãË°åÁ®ã</div>
                <div class="hero-title">ËºâÂÖ•‰∏≠...</div>
                <div class="hero-time"></div>
            </div>
        </div>

        <div id="timeline-container"></div>
    </div>

    <div id="tab-info" class="section">
        
        <div class="luggage-alert">
            üß≥ <b>Ë°åÊùéÊ≥®ÊÑè Luggage Info</b><br>
            ‚Ä¢ Ë®óÈÅã Checked: <b>23kg</b><br>
            ‚Ä¢ ÊâãÊèê Hand: <b>7kg</b><br>
            ‚Ä¢ Èö®Ë∫´Â∞èÂåÖ: ÁôªÂ±±ÂÅ•Ë°åÁî® (Áõ∏Ê©ü/Ê∞¥/ÊØõÂ∑æ)
        </div>

        <div id="flights-container"></div>
        
        <div class="card stay">
            <div class="card-title">üè® ‰ΩèÂÆøË≥áË®ä</div>
            <div class="card-desc">
                <b>Best Western Plus Jeddah</b><br>Madinah Road, Jeddah<br>
                <b>Socotra Camping</b><br>Erisel / Fermhin / Detwah (Private Tent)<br>
                <b>Grande Signature Apartments</b><br>Downtown Dubai
            </div>
        </div>

        <div class="card activity">
            <div class="card-title">üó∫Ô∏è Â∞éËà™Âú∞Âúñ</div>
            <a href="http://googleusercontent.com/maps.google.com/8" target="_blank" class="btn-map" style="width:100%; justify-content:center;">ÈñãÂïü Google Maps</a>
        </div>
    </div>

    <div id="tab-checklist" class="section">
        <div class="progress-box">
            <div class="progress-text">
                <span>ÊâìÂåÖÈÄ≤Â∫¶</span>
                <span id="progress-val">0%</span>
            </div>
            <div class="progress-bar-bg">
                <div class="progress-bar-fill" id="progress-fill"></div>
            </div>
        </div>

        <div id="checklist-container"></div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('timeline', this)">
            <span class="nav-icon">üìÖ</span>Ë°åÁ®ã
        </div>
        <div class="nav-item" onclick="switchTab('info', this)">
            <span class="nav-icon">‚úàÔ∏è</span>Ëà™Áè≠
        </div>
        <div class="nav-item" onclick="switchTab('checklist', this)">
            <span class="nav-icon">üéí</span>ÊâìÂåÖ
        </div>
    </nav>

    <script>
        // --- DATA ---

        // Flight Data (Detailed)
        const flightData = [
            {
                airline: "Emirates 367", date: "2026-02-15",
                from: "TPE", to: "DXB",
                dep: "23:00", arr: "04:50",
                dur: "9h 50m", term: "Arriving T3",
                link: "https://live.flighty.app/a670880c-7751-407c-b5a8-87722467c0e1"
            },
            {
                airline: "flynas 502", date: "2026-02-16",
                from: "DXB", to: "JED",
                dep: "12:20", arr: "14:45",
                dur: "3h 25m", term: "Arriving T1",
                link: "https://live.flighty.app/5b0a7877-68a6-4356-923c-aac7d4f6912b"
            },
            {
                airline: "Yemenia 525", date: "2026-02-17",
                from: "JED", to: "SCT",
                dep: "11:00", arr: "14:30",
                dur: "3h 30m", term: "Terminal --",
                link: "https://live.flighty.app/a7876470-8921-4d2b-a687-47d8713935e8"
            },
            {
                airline: "Yemenia 526", date: "2026-02-23",
                from: "SCT", to: "JED",
                dep: "10:30", arr: "14:00",
                dur: "3h 30m", term: "Arriving T1",
                link: "https://live.flighty.app/bff8399b-7d51-49be-a55c-087b1584a38a"
            },
            {
                airline: "flynas 505", date: "2026-02-23",
                from: "JED", to: "DXB",
                dep: "17:00", arr: "20:45",
                dur: "2h 45m", term: "Arriving T1",
                link: "https://live.flighty.app/d39029e5-fb8c-41c2-90d2-ffb64f9ae9c9"
            },
            {
                airline: "Emirates 386", date: "2026-02-26",
                from: "DXB", to: "TPE",
                dep: "08:45", arr: "20:40",
                dur: "7h 55m", term: "Arriving T2",
                link: "https://live.flighty.app/c7c0ba09-1b65-40f0-b564-3e7ee2a59da9"
            }
        ];

        // Itinerary Data (With Timestamps for Logic)
        const itinerary = [
            {
                date: "2/15 (Êó•)", items: [
                    { t: "2026-02-15T23:00", time: "23:00", title: "EK367 Ëµ∑È£õ", type: "transport", desc: "ÂâçÂæÄÊùúÊãú | È£õË°åÊôÇÈñì 9hr 50m", nav: "Taoyuan Airport" }
                ]
            },
            {
                date: "2/16 (‰∏Ä)", items: [
                    { t: "2026-02-16T04:50", time: "04:50", title: "ÊäµÈÅîÊùúÊãú (DXB)", type: "transport", desc: "ËΩâÊ©üÁ≠âÂæÖ" },
                    { t: "2026-02-16T12:20", time: "12:20", title: "XY502 È£õÂæÄÂêâÈÅî", type: "transport", desc: "FlyNas Ëà™Á©∫" },
                    { t: "2026-02-16T16:00", time: "16:00", title: "Check-in È£ØÂ∫ó", type: "stay", desc: "Best Western Plus Jeddah Hotel", nav: "Best Western Plus Jeddah Hotel" },
                    { t: "2026-02-16T19:00", time: "19:00", title: "Waterfront Dinner", type: "food", desc: "ÂêâÈÅîÊø±Êµ∑Ë∑ØÊï£Ê≠•ËàáÊôöÈ§ê", nav: "Jeddah Corniche" }
                ]
            },
            {
                date: "2/17 (‰∫å)", items: [
                    { t: "2026-02-17T11:00", time: "11:00", title: "È£õÂæÄÁ¥¢ÁßëÁâπÊãâ", type: "transport", desc: "IY525 JED -> SCT" },
                    { t: "2026-02-17T14:30", time: "14:30", title: "ÊäµÈÅî & Majestic Dunes", type: "activity", desc: "ÂâçÂæÄÊù±ÈÉ®ÔºåÈÄîÁ∂ìÈ¶ñÈÉΩ HadiboÔºåÈÅ†Áú∫ Hajhair Â±±ËÑà„ÄÇ" },
                    { t: "2026-02-17T18:00", time: "Night", title: "Erisel Beach Èú≤Ááü", type: "stay", desc: "Á¨¨‰∏ÄÊôöÊµ∑ÁÅòÁßÅ‰∫∫Â∏≥ÁØ∑Ôºå‰∫´ÂèóÊòüÁ©∫„ÄÇ", nav: "Arher Beach" }
                ]
            },
            {
                date: "2/18 (‰∏â)", items: [
                    { t: "2026-02-18T05:30", time: "Sunrise", title: "Arher Sand Dunes", type: "activity", desc: "ÂøÖÁúãÊó•Âá∫ÔºÅÊªëÊ≤ô„ÄÅÊó©È§êÊôÇÁïôÊÑèÊµ∑Ë±ö„ÄÇ" },
                    { t: "2026-02-18T10:00", time: "Morning", title: "Dihamri Êµ∑Ê¥ã‰øùË≠∑ÂçÄ", type: "activity", desc: "ÊµÆÊΩõÁÜ±ÈªûÔºåË±êÂØåÁèäÁëöËàáÈ≠öÁæ§„ÄÇ" },
                    { t: "2026-02-18T14:00", time: "Afternoon", title: "Homhil ÁÑ°ÈÇäÈöõÊ≥≥Ê±†", type: "activity", desc: "ÁµïÁæéÂ§©ÁÑ∂Ê≥≥Ê±†ÔºåÁú∫ÊúõÂåóÂ≤∏„ÄÇÊ≤øÈÄîÂèØË¶ãÁì∂Â≠êÊ®π„ÄÇ" },
                    { t: "2026-02-18T18:00", time: "Night", title: "Erisel Beach Èú≤Ááü", type: "stay", desc: "ËøîÂõûÊù±Â≤∏ÁáüÂú∞ÈÅéÂ§ú„ÄÇ" }
                ]
            },
            {
                date: "2/19 (Âõõ)", items: [
                    { t: "2026-02-19T08:00", time: "Morning", title: "Kaleesan White Canyon", type: "activity", desc: "ÁôΩËâ≤Â≥ΩË∞∑ËàáËîöËóçÊ±†Ê∞¥ÔºåÈÅ©ÂêàÊ∏∏Ê≥≥Ë∑≥Ê∞¥„ÄÇ" },
                    { t: "2026-02-19T14:00", time: "Afternoon", title: "Zahek Desert & Camel", type: "activity", desc: "Ê≤ôÊº†Êº´Ê≠•ËàáÈ®éÈß±ÈßùÔºåÈ´îÈ©óÈòøÊãâ‰ºØ‰πãÂ§úÊ∞õÂúç„ÄÇ" },
                    { t: "2026-02-19T16:00", time: "Stop", title: "Digub Cave", type: "activity", desc: "Â∑®Â§ßÊ¥ûÁ©¥Ôºå‰øØÁû∞ÂçóÂ≤∏ÁæéÊôØ„ÄÇ" },
                    { t: "2026-02-19T18:00", time: "Night", title: "Fermhin Forest Camp", type: "stay", desc: "‰∏ñÁïåÊúÄÂ§ßÈæçË°ÄÊ®πÊ£ÆÊûóÈú≤Ááü„ÄÇ" }
                ]
            },
            {
                date: "2/20 (‰∫î)", items: [
                    { t: "2026-02-20T06:00", time: "Sunrise", title: "ÈæçË°ÄÊ®πÊ£ÆÊûóÊó•Âá∫", type: "activity", desc: "Êé¢Á¥¢ÁâπÊúâÁ®ÆÂãïÊ§çÁâ©Ôºå‰∫´ÂèóÈ≠îÂπªÊôÇÂàª„ÄÇ" },
                    { t: "2026-02-20T14:00", time: "Afternoon", title: "ÊãúË®™ Bedouin ÊùëËêΩ", type: "activity", desc: "È´îÈ©óÁï∂Âú∞ÁîüÊ¥ªÔºåÂèÉËßÄÈæçË°ÄÊ®πËãóÂúÉ„ÄÇ" },
                    { t: "2026-02-20T18:00", time: "Night", title: "Fermhin Forest Camp", type: "stay", desc: "ÁπºÁ∫åÂú®Ê£ÆÊûó‰∏≠Èú≤Ááü„ÄÇ" }
                ]
            },
            {
                date: "2/21 (ÂÖ≠)", items: [
                    { t: "2026-02-21T09:00", time: "Day", title: "Detwah Lagoon", type: "activity", desc: "ÂøÖË®™ËóçËâ≤ÊΩüÊπñÔºÅÁôΩÊ≤ôËàáËóçÊ∞¥ÁöÑÊ•µËá¥Â∞çÊØî„ÄÇ" },
                    { t: "2026-02-21T17:00", time: "Sunset", title: "ÊΩüÊπñÂ±±È†ÇÊó•ËêΩ", type: "activity", desc: "Áà¨‰∏äÂ±±‰∏òÂ∞ãÊâæÂ≠§Áç®Áì∂Â≠êÊ®πÔºå‰øØÁû∞ÂÖ®ÊôØ„ÄÇ" },
                    { t: "2026-02-21T19:00", time: "Night", title: "Detwah Lagoon Camp", type: "stay", desc: "ÊΩüÊπñÊóÅÂ∞àÂ±¨ÁáüÂú∞„ÄÇ" }
                ]
            },
            {
                date: "2/22 (Êó•)", items: [
                    { t: "2026-02-22T08:00", time: "Morning", title: "Shoab Golden Beach", type: "activity", desc: "Êê≠ËàπÂâçÂæÄÈªÉÈáëÊµ∑ÁÅòÔºåÂ∞ãÊâæÊµ∑Ë±ö (Spinner Dolphins)„ÄÇ" },
                    { t: "2026-02-22T14:00", time: "Afternoon", title: "Qalansiyah Â∞èÈéÆ", type: "activity", desc: "ÂèÉËßÄÂ≥∂‰∏äÁ¨¨‰∫åÂ§ßÂüéÈéÆÔºåÊµ∑ÁÅòÊîæÈ¨Ü„ÄÇ" },
                    { t: "2026-02-22T18:00", time: "Night", title: "Detwah Lagoon Camp", type: "stay", desc: "ÊúÄÂæå‰∏ÄÊôöÈú≤Ááü„ÄÇ" }
                ]
            },
            {
                date: "2/23 (‰∏Ä)", items: [
                    { t: "2026-02-23T08:00", time: "Morning", title: "ÂëäÂà•Á¥¢ÁßëÁâπÊãâ", type: "activity", desc: "ÈÄîÁ∂ì‰∫åÊà∞‰øÑÁæÖÊñØÂù¶ÂÖãÈÅ∫Ë∑°ÊãçÁÖß„ÄÇ" },
                    { t: "2026-02-23T10:30", time: "10:30", title: "È£õÂæÄÂêâÈÅî (IY526)", type: "transport", desc: "Êº´Èï∑ÁöÑËΩâÊ©üË°åÁ®ã" },
                    { t: "2026-02-23T17:00", time: "17:00", title: "È£õÂæÄÊùúÊãú (XY505)", type: "transport", desc: "ËøîÂõû UAE" },
                    { t: "2026-02-23T22:00", time: "Night", title: "Check-in", type: "stay", desc: "Grande Signature Apartments", nav: "Grande Signature Apartments Dubai" }
                ]
            },
            {
                date: "2/24 (‰∫å)", items: [
                    { t: "2026-02-24T09:00", time: "Morning", title: "Â§ßÊ∏ÖÁúüÂØ∫", type: "activity", desc: "Ê≥®ÊÑèÊúçË£ùÔºÅSheikh Zayed Grand Mosque" },
                    { t: "2026-02-24T12:00", time: "Noon", title: "ÁæÖÊµÆÂÆÆÂçöÁâ©È§®", type: "activity", desc: "Louvre Abu Dhabi" },
                    { t: "2026-02-24T15:00", time: "Afternoon", title: "È®éÈ¶¨È´îÈ©ó", type: "activity", desc: "‰∏ãÂçàÊ¥ªÂãï" },
                    { t: "2026-02-24T19:00", time: "Dinner", title: "Time Out Market", type: "food", desc: "ÊôöÈ§êËàáÂìàÈáåÁôºÂ°îÊ∞¥ËàûÁßÄ", nav: "Time Out Market Dubai" }
                ]
            },
            {
                date: "2/25 (‰∏â)", items: [
                    { t: "2026-02-25T10:00", time: "Day", title: "ÊùúÊãúÂüéÂ∏ÇÈ´îÈ©ó", type: "activity", desc: "ËàäÂüéÂçÄÊï£Ê≠•„ÄÅÂìàÈáåÁôºÂ°î 124F Â±ïÊúõÂè∞" },
                    { t: "2026-02-25T17:00", time: "Dinner", title: "Ê≤ôÊº†ÊôöÈ§ê", type: "food", desc: "Desert Safari" }
                ]
            },
            {
                date: "2/26 (Âõõ)", items: [
                    { t: "2026-02-26T08:45", time: "08:45", title: "EK386 Ëµ∑È£õ", type: "transport", desc: "ËøîÂõûÁîúËúúÁöÑÂÆ∂" }
                ]
            }
        ];

        const checklistData = {
            "Èö®Ë∫´ÂåÖ": ["ÊâãÊ©ü", "Ë≠∑ÁÖß", "Visa (Á¥ôÊú¨+ÊâãÊ©ü)", "Ê©üÁ•® / ÈõªÂ≠êÁ•®", "Drone permit", "‰øùÈö™Ë≥áÊñô", "‰ø°Áî®Âç°", "ÁæéÈáëÁèæÈáë (Êñ∞Èàî)", "Â∞èË≤ª", "Ë°åÂãïÈõªÊ∫ê", "ÂÖÖÈõªÁ∑ö", "ËΩâÊé•È†≠ ‚≠ê", "ËÄ≥Ê©ü", "È†∏Êûï/ÁúºÁΩ©", "Ë≠∑ÂîáËÜè", "Èö±ÂΩ¢ÁúºÈè°+Ëó•Ê∞¥", "ÁúºÈè°", "Ë®òÊÜ∂Âç°", "Á≠Ü"],
            "Ë°£Áâ©ÈûãÂ±•": ["‰∏äË°£", "Áü≠Ë§≤", "Èï∑Ë§≤", "Áù°Ë°£", "ÂÖßË°£Ë§≤", "Ê≥≥Ë°£", "Èï∑Ë£ô/Èï∑Ë§≤ (Ê∏ÖÁúüÂØ∫)", "ÂÅ•Ë°åÈûã", "Ê∂ºÈûã/ÊãñÈûã"],
            "Èò≤Êõ¨Êà∂Â§ñ": ["Â§™ÈôΩÁúºÈè°", "Â∏ΩÂ≠ê", "SPF50Èò≤Êõ¨", "ËòÜËñà", "UVÁΩ©Ë°´", "Ê∞¥ÊØçË°£", "È†≠Ááà", "Âø´‰πæÊØõÂ∑æ", "ÊøïÁ¥ôÂ∑æ", "Áõ•Ê¥óÁî®ÂìÅ", "‰øùÊøï‰π≥Ê∂≤", "Ê∞¥Â£∫"],
            "ÈõªÂ≠êÂÖ∂‰ªñ": ["Áõ∏Ê©ü+ÈõªÊ±†", "Drone+ÂÇôÈõª", "Èò≤Ê∞¥Ë¢ã", "Èò≤Â°µÂè£ÁΩ©/Buff", "Èõ∂È£ü", "Á©∫Ë≥ºÁâ©Ë¢ã"]
        };

        // --- FUNCTIONS ---

        function init() {
            renderTimeline();
            updateUpNext();
            renderFlights();
            renderChecklist();
            
            // Auto update countdown
            setInterval(updateUpNext, 60000);
        }

        // 1. Up Next Logic
        function updateUpNext() {
            const now = new Date();
            // To simulate being on the trip if testing today, you can uncomment below:
            // const now = new Date("2026-02-16T10:00:00"); 

            let nextItem = null;
            let minDiff = Infinity;

            // Find nearest future event
            for (const day of itinerary) {
                for (const item of day.items) {
                    const itemTime = new Date(item.t);
                    const diff = itemTime - now;
                    if (diff > 0 && diff < minDiff) {
                        minDiff = diff;
                        nextItem = { ...item, diff: diff };
                    }
                }
            }

            const heroContainer = document.querySelector('.hero-card');
            if (nextItem) {
                const hours = Math.floor(nextItem.diff / (1000 * 60 * 60));
                const mins = Math.floor((nextItem.diff % (1000 * 60 * 60)) / (1000 * 60));
                
                let timeString = "";
                if (hours > 24) {
                    const days = Math.floor(hours / 24);
                    timeString = `ÈÇÑÊúâ ${days} Â§©`;
                } else if (hours > 0) {
                    timeString = `ÈÇÑÊúâ ${hours} Â∞èÊôÇ ${mins} ÂàÜ`;
                } else {
                    timeString = `ÈÇÑÊúâ ${mins} ÂàÜÈêò`;
                }

                heroContainer.innerHTML = `
                    <div class="hero-label">UP NEXT ‰∏ã‰∏ÄÂÄãË°åÁ®ã</div>
                    <div class="hero-title">${nextItem.title}</div>
                    <div class="hero-time">
                        <span>${nextItem.time}</span>
                        <span>‚Ä¢</span>
                        <span>${nextItem.desc.split('|')[0]}</span>
                    </div>
                    <div class="countdown-badge">‚è≥ ${timeString}</div>
                `;
            } else {
                heroContainer.innerHTML = `<div class="hero-title">ÊóÖÁ®ãÂ∑≤ÁµêÊùü ‚ú®</div>`;
            }
        }

        // 2. Checklist Progress
        function updateProgress() {
            const savedState = JSON.parse(localStorage.getItem('judyTripChecklist')) || {};
            let total = 0;
            let checked = 0;
            
            // Count items
            Object.values(checklistData).forEach(arr => {
                total += arr.length;
                arr.forEach(item => {
                    if (savedState[item]) checked++;
                });
            });

            const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
            document.getElementById('progress-val').textContent = `Â∑≤ÂÆåÊàê ${checked} / ${total} (${percent}%)`;
            document.getElementById('progress-fill').style.width = `${percent}%`;
        }

        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            let html = '';
            const savedState = JSON.parse(localStorage.getItem('judyTripChecklist')) || {};

            for (const [category, items] of Object.entries(checklistData)) {
                html += `<div class="check-group"><div class="check-title">${category}</div>`;
                items.forEach(item => {
                    const isChecked = savedState[item] ? 'checked' : '';
                    html += `
                        <div class="check-item ${isChecked}" onclick="toggleCheck(this, '${item}')">
                            <div class="checkbox"></div>
                            <span>${item}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            container.innerHTML = html;
            updateProgress();
        }

        function toggleCheck(el, item) {
            el.classList.toggle('checked');
            const savedState = JSON.parse(localStorage.getItem('judyTripChecklist')) || {};
            
            if (el.classList.contains('checked')) {
                savedState[item] = true;
            } else {
                delete savedState[item];
            }
            localStorage.setItem('judyTripChecklist', JSON.stringify(savedState));
            updateProgress();
        }

        // 3. Render Flights
        function renderFlights() {
            const container = document.getElementById('flights-container');
            container.innerHTML = flightData.map(f => `
                <div class="flight-card">
                    <div class="fc-header">
                        <span class="fc-airline">${f.airline}</span>
                        <span class="fc-date">${f.date}</span>
                    </div>
                    <div class="fc-route">
                        <span class="fc-city">${f.from}</span>
                        <span class="fc-arrow">‚ûî</span>
                        <span class="fc-city">${f.to}</span>
                    </div>
                    <div class="fc-times">
                        <span>‚Üó ${f.dep}</span>
                        <span>‚Üò ${f.arr}</span>
                    </div>
                    <div class="fc-meta">
                        <span>‚è± ${f.dur}</span>
                        <span>${f.term}</span>
                    </div>
                    <a href="${f.link}" target="_blank" class="fc-link">Flighty Updates ></a>
                </div>
            `).join('');
        }

        // 4. Render Timeline
        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = itinerary.map(day => `
                <div class="date-header">${day.date}</div>
                ${day.items.map(item => `
                    <div class="card ${item.type}">
                        <span class="card-time">${item.time}</span>
                        <div class="card-title">${item.title}</div>
                        <div class="card-desc">${highlightText(item.desc)}</div>
                        ${item.nav ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.nav)}" target="_blank" class="btn-map">üìç Â∞éËà™</a>` : ''}
                    </div>
                `).join('')}
            `).join('');
        }

        function highlightText(text) {
            const rules = [
                { regex: /(ÂøÖÊãç|ÂøÖÁúã|ÂøÖË®™|Êó•Âá∫|Êµ∑Ë±ö)/g, class: "hl" },
                { regex: /(Ë≠∑ÁÖß|Visa|ÁèæÈáë|Ê≥®ÊÑè|ÊúçË£ù)/g, class: "hl" }
            ];
            let newText = text;
            rules.forEach(rule => {
                newText = newText.replace(rule.regex, match => `<span class="${rule.class}">${match}</span>`);
            });
            return newText;
        }

        function switchTab(tabId, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            btn.classList.add('active');
            window.scrollTo(0,0);
        }

        init();
    </script>
</body>
</html>
