<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é¾è¡€æ˜ æ²™ | Travel Quick Guide</title>
    <style>
        :root {
            /* æ—¥å¼æ¥µç°¡é…è‰² / ä¸­æ±æ²™æ¼ è‰²èª¿ */
            --bg-color: #FAFAFA;
            --card-bg: #FFFFFF;
            --text-main: #333333;
            --text-sub: #888888;
            --accent-sand: #D4A373; /* æ²™æ¼ é‡‘ */
            --accent-ocean: #6B9080; /* ç´¢ç§‘ç‰¹æ‹‰æµ·è— */
            --accent-alert: #E76F51;
            --border-radius: 16px;
            --shadow: 0 4px 12px rgba(0,0,0,0.05);
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: var(--font-family);
            color: var(--text-main);
            padding-bottom: 80px; /* Space for bottom nav */
        }

        /* Header */
        header {
            background: var(--card-bg);
            padding: 20px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 { margin: 0; font-size: 18px; font-weight: 700; letter-spacing: 0.5px; }
        .subtitle { font-size: 12px; color: var(--text-sub); display: block; margin-top: 4px; }

        /* Navigation Tabs */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid #eee;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            z-index: 1000;
        }

        .nav-item {
            text-align: center;
            font-size: 10px;
            color: #ccc;
            cursor: pointer;
            flex: 1;
        }

        .nav-item.active { color: var(--text-main); font-weight: 600; }
        .nav-icon { font-size: 20px; display: block; margin-bottom: 4px; }

        /* Content Sections */
        .section { display: none; padding: 20px; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Timeline Cards */
        .day-header {
            margin: 30px 0 15px 0;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-sub);
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .weather-badge {
            font-size: 12px;
            background: #F0F4F8;
            padding: 4px 10px;
            border-radius: 20px;
            color: var(--text-sub);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            position: relative;
            border-left: 4px solid transparent;
            transition: transform 0.2s;
        }

        .card:active { transform: scale(0.98); }

        /* Card Types */
        .card.transport { border-left-color: #A5A58D; }
        .card.activity { border-left-color: var(--accent-sand); }
        .card.stay { border-left-color: var(--text-main); }
        .card.food { border-left-color: var(--accent-alert); }

        .card-time { font-size: 12px; color: var(--text-sub); font-weight: 600; margin-bottom: 4px; }
        .card-title { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
        .card-desc { font-size: 13px; color: #666; line-height: 1.5; margin-bottom: 12px; }

        /* Tags & Highlights */
        .tag {
            display: inline-block;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 4px;
            margin-right: 6px;
            font-weight: 600;
        }
        .tag.guide { background: #FFF3E0; color: #E67E22; }
        .tag.must-buy { background: #E8F5E9; color: #2E7D32; }

        /* Action Buttons */
        .actions { display: flex; gap: 10px; margin-top: 10px; }
        .btn-map {
            background: #F5F5F5;
            color: var(--text-main);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        /* Flights Table */
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { text-align: left; color: var(--text-sub); padding: 8px 0; font-weight: 500; font-size: 11px; }
        td { padding: 12px 0; border-bottom: 1px solid #eee; }
        .flight-row { display: grid; grid-template-columns: 0.8fr 1.5fr 1fr; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }

        /* Budget Section */
        .budget-box {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }
        .budget-total { font-size: 32px; font-weight: 700; color: var(--text-main); margin: 10px 0; }
        .input-group { display: flex; gap: 10px; margin-top: 10px; }
        input { flex: 1; padding: 10px; border: 1px solid #eee; border-radius: 8px; background: #FAFAFA; }
        button.add-btn { background: var(--text-main); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; }
        .expense-list { list-style: none; padding: 0; margin-top: 20px; }
        .expense-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f0f0f0; font-size: 14px; }

        /* Checklist */
        .checklist-category { margin-top: 20px; }
        .category-title { font-size: 14px; font-weight: 700; margin-bottom: 10px; color: var(--accent-ocean); }
        .check-item {
            background: var(--card-bg);
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }
        .check-item.checked { opacity: 0.5; text-decoration: line-through; background: transparent; }
        .checkbox-circle {
            width: 20px; height: 20px;
            border: 2px solid #ddd;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
        }
        .checked .checkbox-circle { background: var(--accent-ocean); border-color: var(--accent-ocean); }
        .checked .checkbox-circle::after { content: 'âœ“'; color: white; font-size: 12px; }

    </style>
</head>
<body>

    <header>
        <div>
            <h1>èŠ±å¤©Judyçš„å†’éšª</h1>
            <span class="subtitle">é¾è¡€æ˜ æ²™ï½œTravel Quick Guide</span>
        </div>
        <div style="font-size: 12px; font-weight: bold; padding: 6px 12px; background: #eee; border-radius: 20px;">
            11 Days
        </div>
    </header>

    <div id="tab-timeline" class="section active">
        </div>

    <div id="tab-info" class="section">
        <h2 style="font-size: 18px; margin-bottom: 20px;">âœˆï¸ èˆªç­è³‡è¨Š</h2>
        <div class="card" style="padding: 20px;">
            <div id="flight-list"></div>
        </div>

        <h2 style="font-size: 18px; margin: 30px 0 20px 0;">ğŸ’° è¨˜å¸³èˆ‡é ç®—</h2>
        <div class="budget-box">
            <div style="font-size: 12px; color: #888;">ç›®å‰èŠ±è²» (USD)</div>
            <div class="budget-total">$0</div>
            <div class="input-group">
                <input type="text" id="expense-name" placeholder="é …ç›® (e.g. æ™šé¤)">
                <input type="number" id="expense-amount" placeholder="é‡‘é¡">
                <button class="add-btn" onclick="addExpense()">+</button>
            </div>
            <ul class="expense-list" id="expense-list"></ul>
        </div>

        <h2 style="font-size: 18px; margin: 30px 0 20px 0;">ğŸ¨ ä½å®¿åˆ—è¡¨</h2>
        <div class="card stay">
            <div class="card-time">Jeddah</div>
            <div class="card-title">Best Western Plus</div>
            <a href="https://www.google.com/maps/search/?api=1&query=Best+Western+Plus+Jeddah" target="_blank" class="btn-map">ğŸ“ å°èˆª</a>
        </div>
        <div class="card stay">
            <div class="card-time">Socotra</div>
            <div class="card-title">Camping & Hotels</div>
            <div class="card-desc">Erisel Beach, Fermhin Forest, Detwah Lagoon</div>
        </div>
        <div class="card stay">
            <div class="card-time">Dubai</div>
            <div class="card-title">Grande Signature Apartments</div>
            <a href="https://www.google.com/maps/search/?api=1&query=Grande+Signature+Apartments+Dubai" target="_blank" class="btn-map">ğŸ“ å°èˆª</a>
        </div>
    </div>

    <div id="tab-checklist" class="section">
        <h2 style="font-size: 18px; margin-bottom: 20px;">ğŸ’ æ‰“åŒ…æ¸…å–®</h2>
        <div id="checklist-container"></div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('timeline', this)">
            <span class="nav-icon">ğŸ“…</span>
            è¡Œç¨‹
        </div>
        <div class="nav-item" onclick="switchTab('info', this)">
            <span class="nav-icon">âœˆï¸</span>
            è³‡è¨Š
        </div>
        <div class="nav-item" onclick="switchTab('checklist', this)">
            <span class="nav-icon">âœ…</span>
            æ‰“åŒ…
        </div>
    </nav>

    <script>
        // --- DATA ---
        const flights = [
            { date: "2/15", route: "TPE â†’ DXB", code: "EK367", time: "23:00 â†’ 04:50" },
            { date: "2/16", route: "DXB â†’ JED", code: "XY502", time: "12:20 â†’ 14:45" },
            { date: "2/17", route: "JED â†’ SCT", code: "IY525", time: "11:00 â†’ 14:30" },
            { date: "2/23", route: "SCT â†’ JED", code: "IY526", time: "10:30 â†’ 14:00" },
            { date: "2/23", route: "JED â†’ DXB", code: "XY505", time: "17:00 â†’ 20:45" },
            { date: "2/26", route: "DXB â†’ TPE", code: "EK386", time: "08:45 â†’ 20:40" }
        ];

        const itinerary = [
            {
                date: "2/15 Sun",
                city: "Taipei",
                location: "TPE Airport",
                lat: 25.0797, lon: 121.2342,
                items: [
                    { type: "transport", time: "23:00", title: "EK367 èµ·é£›", desc: "å‰å¾€æœæ‹œ | é£›è¡Œæ™‚é–“ç´„ 9hr", nav: null }
                ]
            },
            {
                date: "2/16 Mon",
                city: "Dubai / Jeddah",
                location: "Jeddah",
                lat: 21.4858, lon: 39.1925,
                items: [
                    { type: "transport", time: "04:50", title: "æŠµé”æœæ‹œ (è½‰æ©Ÿ)", desc: "ç­‰å¾…è½‰æ©Ÿå‰å¾€å‰é”", nav: "DXB Airport" },
                    { type: "transport", time: "14:45", title: "æŠµé”å‰é”", desc: "å…¥å¢ƒæ²™çƒåœ°é˜¿æ‹‰ä¼¯", nav: "King Abdulaziz International Airport" },
                    { type: "stay", time: "Check-in", title: "Best Western Plus", desc: "æ”¾ç½®è¡Œæ", nav: "Best Western Plus Jeddah" },
                    { type: "food", time: "Dinner", title: "Waterfront Dinner", desc: "<span class='tag guide'>å¿…å»</span>å‰é”æ¿±æµ·è·¯ Corniche æ•£æ­¥", nav: "Jeddah Corniche" }
                ]
            },
            {
                date: "2/17 Tue",
                city: "Socotra",
                location: "Socotra",
                lat: 12.4634, lon: 53.8237,
                items: [
                    { type: "transport", time: "14:30", title: "æŠµé”ç´¢ç§‘ç‰¹æ‹‰", desc: "èˆ‡å°éŠæœƒåˆï¼Œæ­ä¹˜ 4x4", nav: "Socotra Airport" },
                    { type: "stay", time: "Evening", title: "Erisel Beach éœ²ç‡Ÿ", desc: "<span class='tag guide'>è§€æ˜Ÿ</span> ç¬¬ä¸€æ™šæµ·ç˜éœ²ç‡Ÿé«”é©—", nav: "Erisel Beach Socotra" }
                ]
            },
            {
                date: "2/18 Wed",
                city: "Socotra",
                location: "Socotra",
                lat: 12.4634, lon: 53.8237,
                items: [
                    { type: "activity", time: "Morning", title: "Arher ç™½æ²™ä¸˜", desc: "<span class='tag guide'>æ”å½±ç†±é»</span> å·¨å¤§ç™½æ²™ä¸˜èˆ‡æ—¥å‡ºï¼Œå¯æ»‘æ²™", nav: "Arher Beach" },
                    { type: "activity", time: "Afternoon", title: "Homhil ä¿è­·å€", desc: "<span class='tag guide'>çµ•æ™¯</span> å¤©ç„¶ç„¡é‚Šéš›æ³³æ±  (Infinity Pool)", nav: "Homhil Protected Area" }
                ]
            },
            {
                date: "2/19 Thu",
                city: "Socotra",
                location: "Socotra",
                lat: 12.4634, lon: 53.8237,
                items: [
                    { type: "activity", time: "All Day", title: "Dixam é«˜åŸ & å³½è°·", desc: "æ¢è¨ªç™½è‰²å³½è°· (Kaleesan) èˆ‡é¾è¡€æ¨¹", nav: "Dixam Plateau" },
                    { type: "stay", time: "Night", title: "Fermhin Forest Camp", desc: "åœ¨ä¸–ç•Œæœ€å¤§çš„é¾è¡€æ¨¹æ£®æ—éœ²ç‡Ÿ", nav: "Fermhin Forest" }
                ]
            },
            {
                date: "2/20 Fri",
                city: "Socotra",
                location: "Socotra",
                lat: 12.4634, lon: 53.8237,
                items: [
                    { type: "activity", time: "Morning", title: "é¾è¡€æ¨¹æ£®æ—æ¼«æ­¥", desc: "<span class='tag guide'>ä¸–ç•Œéºç”¢</span> ç´¢ç§‘ç‰¹æ‹‰æ¨™èªŒæ€§æ™¯è§€", nav: "Dragon Blood Tree Forest" },
                    { type: "activity", time: "Afternoon", title: "Bedouin æ‘è½é«”é©—", desc: "é«”é©—ç•¶åœ°è²éƒ½å› æ–‡åŒ–", nav: null }
                ]
            },
            {
                date: "2/21 Sat",
                city: "Socotra",
                location: "Socotra",
                lat: 12.4634, lon: 53.8237,
                items: [
                    { type: "activity", time: "Day", title: "Detwah Lagoon", desc: "<span class='tag guide'>å¿…çœ‹</span> çµ•ç¾è—è‰²æ½Ÿæ¹–èˆ‡ç™½è‰²æ²™ç˜", nav: "Detwah Lagoon" },
                    { type: "activity", time: "Sunset", title: "æ½Ÿæ¹–æ—¥è½ç™»å±±", desc: "çˆ¬ä¸Šå°å±±ä¸˜ä¿¯ç°å…¨æ™¯", nav: null }
                ]
            },
            {
                date: "2/22 Sun",
                city: "Socotra",
                location: "Socotra",
                lat: 12.4634, lon: 53.8237,
                items: [
                    { type: "activity", time: "Morning", title: "Shoab Beach èˆ¹éŠ", desc: "<span class='tag guide'>ç”Ÿæ…‹</span> å°‹æ‰¾æµ·è±š (Spinner Dolphins)", nav: "Shoab Beach" },
                    { type: "activity", time: "Afternoon", title: "Qalansiyah", desc: "å³¶ä¸Šç¬¬äºŒå¤§åŸé®æ•£ç­–", nav: "Qalansiyah" }
                ]
            },
            {
                date: "2/23 Mon",
                city: "Dubai",
                location: "Dubai",
                lat: 25.2048, lon: 55.2708,
                items: [
                    { type: "transport", time: "20:45", title: "æŠµé”æœæ‹œ", desc: "æ¥æ©Ÿä¸¦å‰å¾€å¸‚å€", nav: "DXB Airport" },
                    { type: "stay", time: "Check-in", title: "Grande Signature", desc: "Downtown Dubai", nav: "Grande Signature Apartments" }
                ]
            },
            {
                date: "2/24 Tue",
                city: "UAE",
                location: "Abu Dhabi",
                lat: 24.4539, lon: 54.3773,
                items: [
                    { type: "activity", time: "Morning", title: "Sheikh Zayed Grand Mosque", desc: "<span class='tag guide'>æœå„€æ³¨æ„</span> å…¨ç™½å¤§ç†çŸ³æ¸…çœŸå¯º", nav: "Sheikh Zayed Grand Mosque" },
                    { type: "activity", time: "Afternoon", title: "Louvre Abu Dhabi", desc: "æµ·ä¸Šç¾…æµ®å®®", nav: "Louvre Abu Dhabi" },
                    { type: "food", time: "Dinner", title: "Time Out Market", desc: "æœæ‹œç¾é£Ÿå¸‚é›†ï¼Œçœ‹æ°´èˆç§€", nav: "Time Out Market Dubai" }
                ]
            },
            {
                date: "2/25 Wed",
                city: "Dubai",
                location: "Dubai",
                lat: 25.2048, lon: 55.2708,
                items: [
                    { type: "activity", time: "Morning", title: "Old District èˆŠåŸå€", desc: "é»ƒé‡‘å¸‚é›†ã€é¦™æ–™å¸‚é›†ã€æ­ä¹˜ Abra èˆ¹", nav: "Deira Old Souq" },
                    { type: "activity", time: "Afternoon", title: "Burj Khalifa 124F", desc: "<span class='tag guide'>é ç´„</span> ä¸–ç•Œæœ€é«˜æ¨“è§€æ™¯å°", nav: "Burj Khalifa" },
                    { type: "activity", time: "Evening", title: "Desert Safari", desc: "æ²™æ¼ è¡æ²™èˆ‡æ™šé¤ç§€", nav: null }
                ]
            }
        ];

        const checklistData = {
            "å¿…å‚™è­‰ä»¶": ["è­·ç…§", "ç°½è­‰ (Visa)", "æ©Ÿç¥¨é›»å­æª”", "æ—…éŠä¿éšªå–®", "ç¾é‡‘ç¾é‡‘ (æ–°éˆ”)", "ä¿¡ç”¨å¡"],
            "ç´¢ç§‘ç‰¹æ‹‰ (æˆ¶å¤–/éœ²ç‡Ÿ)": ["é ­ç‡ˆ (Headlamp)", "å¿«ä¹¾æ¯›å·¾", "è¡Œå‹•é›»æº x2", "æ¿•ç´™å·¾ (å¤§é‡)", "ç’°ä¿è‚¥çš‚/æ´—é«®ç²¾", "æšˆè»Šè—¥", "é˜²èšŠæ¶²"],
            "è¡£ç‰©è£å‚™": ["æ³³è¡£/æ°´æ¯è¡£", "å¥è¡Œé‹/æ¶¼é‹", "è–„å¤–å¥— (æ²™æ¼ æº«å·®)", "é•·è£™/é•·è¤² (é€²æ¸…çœŸå¯ºç”¨)", "å¤ªé™½çœ¼é¡", "é®é™½å¸½"],
            "æ”å½±é›»å­": ["ç›¸æ©Ÿ + å‚™ç”¨é›»æ± ", "ç©ºæ‹æ©Ÿ (éœ€è¨±å¯)", "è¬ç”¨è½‰æ¥é ­ (Type G)", "é˜²æ°´è¢‹ (æµ®æ½›ç”¨)"]
        };

        // --- RENDER LOGIC ---

        function init() {
            renderTimeline();
            renderFlights();
            renderChecklist();
        }

        async function fetchWeather(lat, lon, elementId) {
            try {
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                const data = await res.json();
                const temp = Math.round(data.current_weather.temperature);
                const code = data.current_weather.weathercode;
                let icon = "â˜€ï¸";
                if(code > 3) icon = "â˜ï¸"; 
                if(code > 50) icon = "ğŸŒ§ï¸";
                
                document.getElementById(elementId).innerHTML = `${icon} ${temp}Â°C`;
            } catch (e) {
                document.getElementById(elementId).innerHTML = "ğŸŒ¤ï¸ 25Â°C"; // Fallback
            }
        }

        function renderTimeline() {
            const container = document.getElementById('tab-timeline');
            let html = '';
            
            itinerary.forEach((day, index) => {
                const weatherId = `weather-${index}`;
                // Trigger fetch
                fetchWeather(day.lat, day.lon, weatherId);

                let itemsHtml = day.items.map(item => `
                    <div class="card ${item.type}">
                        <div class="card-time">${item.time}</div>
                        <div class="card-title">${item.title}</div>
                        <div class="card-desc">${item.desc}</div>
                        ${item.nav ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.nav)}" target="_blank" class="btn-map">ğŸ“ å°èˆª</a>` : ''}
                    </div>
                `).join('');

                html += `
                    <div class="day-header">
                        <span>${day.date}</span>
                        <div class="weather-badge" id="${weatherId}">Loading...</div>
                    </div>
                    ${itemsHtml}
                `;
            });
            container.innerHTML = html;
        }

        function renderFlights() {
            const list = document.getElementById('flight-list');
            list.innerHTML = flights.map(f => `
                <div class="flight-row">
                    <div style="font-weight:bold; color:var(--accent-ocean)">${f.date}</div>
                    <div>${f.route}<br><span style="color:#999; font-size:11px">${f.code}</span></div>
                    <div style="text-align:right">${f.time}</div>
                </div>
            `).join('');
        }

        function renderChecklist() {
            const container = document.getElementById('checklist-container');
            let html = '';
            for (const [category, items] of Object.entries(checklistData)) {
                html += `<div class="checklist-category"><div class="category-title">${category}</div>`;
                items.forEach(item => {
                    html += `
                        <div class="check-item" onclick="toggleCheck(this)">
                            <div class="checkbox-circle"></div>
                            <span>${item}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            container.innerHTML = html;
        }

        function toggleCheck(el) {
            el.classList.toggle('checked');
        }

        // Budget Logic
        let total = 0;
        function addExpense() {
            const name = document.getElementById('expense-name').value;
            const amount = parseFloat(document.getElementById('expense-amount').value);
            if (name && amount) {
                total += amount;
                document.querySelector('.budget-total').textContent = `$${total}`;
                const li = document.createElement('li');
                li.className = 'expense-item';
                li.innerHTML = `<span>${name}</span><span>$${amount}</span>`;
                document.getElementById('expense-list').appendChild(li);
                document.getElementById('expense-name').value = '';
                document.getElementById('expense-amount').value = '';
            }
        }

        // Tab Switcher
        function switchTab(tabId, el) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }

        // Init
        init();

    </script>
</body>
</html>
